# Configuring TTS

## Function Introduction

To match different personas and scenarios, you may need to:
- Select different text-to-speech (TTS) vendors, such as Volcano Engine, MiniMax, Aliyun, etc.
- Configure different voices.
- Customize the audio of TTS, such as volume, speed, tone, etc.
- Special rules can filter the content for TTS. For example, in "(happily) The weather is really nice today", the content inside the parentheses will be filtered out.

## Prerequisites

1. Enable AI Agent service
2. Enable corresponding TTS vendor service:
    - Method 1: Experience directly with the zego_test account.
    - Method 2: Purchase TTS service through ZEGO. Please contact ZEGOCLOUD sales to obtain an account and authentication information.
    - Method 3: Purchase TTS service on your own and obtain key information, etc.

## Usage Method

Currently, TTS related parameters can be set through 4 interfaces:
| Interface                                                                                                                                                                                                                        | Description                                                                                                                                                                                                                |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [Register Agent](/aiagent-server/api-reference/agent-configuration-management/register-agent)                                                                                                                                   | Set vendor, voice, speed, etc. parameters.                                                                                                                                                                                        |
| [Create Agent Instance](/aiagent-server/api-reference/agent-instance-management/create-agent-instance)<br/>[Create Digital Human Agent Instance](/aiagent-server/api-reference/agent-instance-management/create-digital-human-agent-instance) | Set vendor, voice, speed, etc. parameters. <br/><Note title="Note">If not set, the TTS parameters carried by the registered Agent ( [RegisterAgent](/aiagent-server/api-reference/agent-configuration-management/register-agent) ) will be used by default.</Note> |
| [Update Agent Instance](/aiagent-server/api-reference/agent-instance-management/update-agent-instance)                                                                                                                             | Set voice, speed, etc. parameters. <Warning title="Note">Does not support modifying the `FilterText` parameter.</Warning>                                                                                                                    |

## TTS Parameters Description <a id="tts-params" />


| Parameter Name | Type            | Required | Description                                                                                                                                                                                                                                                                                                                                                   |
| -------------- | --------------- | -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Vendor         | String          | Yes      | Text-to-speech (TTS) service provider. Optional values: <ul><li>Aliyun: Aliyun TTS (note: this is normal speech synthesis, not CosyVoice).</li><li>CosyVoice: Aliyun CosyVoice TTS</li><li>ByteDance: Volcano Engine unidirectional streaming TTS.</li><li>ByteDanceFlowing: Volcano bidirectional streaming engine TTS.</li><li>MiniMax: MiniMax TTS</li></ul> <br/><Note title="Note">This parameter cannot be updated when updating the agent instance.</Note> |
| Params         | Object          | Yes      | TTS configuration parameters, in JSON object format. Contains app parameters (for authentication) and other parameters (for adjusting TTS effects). Please refer to the Params parameter description below.                                                                                                                                                                                                                                   |
| FilterText     | Array of Object | No       | Filter the text in the specified punctuation symbols, then perform speech synthesis. For example, to filter the content in [] , set it to `[{"BeginCharacters": "[", "EndCharacters": "]"}]`<br/><Note title="Note">This parameter cannot be updated when updating the agent instance.</Note>                                                                                                                                                        |
| TerminatorText | String          | No       | Can be used to set the termination text of TTS. If the content matching the TerminatorText string appears in the text input to TTS, the content from the TerminatorText string (including) will no longer be synthesized. <br/><Note title="Note">Only one character can be set for bidirectional streaming. Maximum length: 4 characters.</Note>                                                                                                             |

### Params Parameters Description <a id="params" />

| Parameter Name | Type   | Required | Description |
| -------------- | ------ | -------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| app            | object | Yes      | Used for TTS service authentication. The structure of the app parameter required varies depending on the value of Vendor. See the app parameter instructions for each vendor below. |
| Other Params   | -      | No       | In addition to the app parameter, you can also pass other TTS configuration parameters to adjust the speech synthesis effect. These parameters will be directly forwarded to the corresponding TTS service provider.<br/><br/>You can refer to the official documentation of each service provider according to the value of Vendor to obtain the required information:<ul><li>Aliyun: [Speech Synthesis - API Reference](https://help.aliyun.com/zh/isi/developer-reference/overview-of-speech-synthesis?spm=a2c4g.11186623.help-menu-30413.d_3_1_0_0.9e5b1f01YvXYPa&scm=20140722.H_84435._.OR_help-T_cn~zh-V_1#section-ljp-l5z-efu)</li><li>CosyVoice: ["payload request parameters" in CosyVoice WebSocket API](https://help.aliyun.com/zh/model-studio/cosyvoice-websocket-api?spm=a2c4g.11186623.help-menu-2400256.d_2_5_0_2.3edf33b47WqNcp)</li><li>ByteDance: [Speech Synthesis API - Parameter List - Request Parameters](https://www.volcengine.com/docs/6561/1257584#%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0)</li><li>ByteDanceFlowing: ["Payload request parameters" in Bidirectional Streaming API - WebSocket Binary Protocol](https://www.volcengine.com/docs/6561/1329505#websocket-%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%8D%8F%E8%AE%AE)</li><li>MiniMax: [Speech Model - T2A v2 - WebSocket - API Request Parameters](https://platform.minimaxi.com/document/T2A%20V2?key=66719005a427f0c8a5701643#PxNsxKPXzZqmI7zIc3O2Wy63)</li></ul> |

The definitions of the `app` parameter and other TTS parameters vary by vendor. Please refer to the parameter instructions for each vendor below.


<Tabs>
<Tab title="Aliyun">

**app Parameters Description**

| Parameter Name | Type   | Required | Description                                                                                                                                                                                                                                                                                                                                                                 |
| ------- | ------ | -------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| app_key | string | Yes      | Please refer to the Aliyun documentation [Smart Voice Interaction - Quick Start - From Here](https://help.aliyun.com/zh/isi/getting-started/start-here?spm=a2c4g.11186623.0.0.44f34b4f40XABA#659bb8103941q) "Step 4: Manage Projects" to get AppKey and enter it here.<br/><br/><Note title="Note">During the test period (within 2 weeks after the AI Agent service is enabled), you can set the parameter value to "zego_test" to use this service.</Note>                 |
| ak_id   | string | Yes      | Please refer to the Aliyun documentation [Smart Voice Interaction - Quick Start - From Here](https://help.aliyun.com/zh/isi/getting-started/start-here?spm=a2c4g.11186623.0.0.44f34b4f40XABA#659bb8103941q) "Step 2: Create AccessKey" to get AccessKey ID and enter it here.<br/><br/><Note title="Note">During the test period (within 2 weeks after the AI Agent service is enabled), you can set the parameter value to "zego_test" to use this service.</Note>     |
| ak_key  | string | Yes      | Please refer to the Aliyun documentation [Smart Voice Interaction - Quick Start - From Here](https://help.aliyun.com/zh/isi/getting-started/start-here?spm=a2c4g.11186623.0.0.44f34b4f40XABA#659bb8103941q) "Step 2: Create AccessKey" to get AccessKey Secret and enter it here.<br/><br/><Note title="Note">During the test period (within 2 weeks after the AI Agent service is enabled), you can set the parameter value to "zego_test" to use this service.</Note> |

**Other Parameters Description**

Below are only some common parameters, for more other parameters, please refer to the parameter description in the [API Reference > Interaction Process > Start Synthesis](https://help.aliyun.com/zh/isi/developer-reference/overview-of-speech-synthesis?spm=a2c4g.11186623.help-menu-30413.d_3_1_0_0.9e5b1f01YvXYPa&scm=20140722.H_84435._.OR_help-T_cn~zh-V_1#section-ljp-l5z-efu) section.

| Parameter Name | Required | Description                                   |
| ----------- | -------- | -------------------------------------- |
| voice       | Yes       | Voice, default is xiaoyun                   |
| volume      | No       | Volume, range: 0~100, default: 50     |
| speech_rate | No       | Speech rate, range: -500~500, default: 0. |
| pitch_rate  | No       | Pitch rate, range: -500~500, default: 0   |

**Parameter Example**

```json
"TTS": {
  "Vendor": "Aliyun",//Required
  "Params": {//Required
    "app": {//Required
      "app_key": "zego_test",//Required
      "ak_id": "zego_test",//Required
      "ak_key": "zego_test"//Required
    },
    "voice": "zhitian_emo",//Required
    //"volume": 50,
    //"speech_rate": 0,
    //"pitch_rate": 0
  }
}
```

</Tab>
<Tab title="CosyVoice">

**app Parameters Description**

| Parameter Name | Type   | Required | Description                                                                                                                                                                                                                                                                                    |
| ------- | ------ | -------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| api_key | string | Yes       | Please refer to the CosyVoice documentation [Get API Key](https://help.aliyun.com/zh/model-studio/get-api-key?spm=a2c4g.11186623.0.0.621433b4VRO9z6) to get api key and enter it here.<br/><br/><Note title="Note">During the test period (within 2 weeks after the AI Agent service is enabled), you can set the parameter value to "zego_test" to use this service.</Note> |

**Other Parameters Description**

Other parameters only have the `payload` parameter, the following is the `payload` parameter and some sub-parameter descriptions, for more parameters, please refer to the parameter description in the [Speech Synthesis CosyVoice WebSocket API > Command (Client → Server) > run-task Command: Start Task > payload Parameter Description](https://help.aliyun.com/zh/model-studio/cosyvoice-websocket-api?spm=a2c4g.11186623.help-menu-2400256.d_2_5_0_2.3edf33b47WqNcp#b0100c3591yqq) section.

| Parameter Name             | Type   | Required | Description                                                                                                                                                              |
| ------------------ | ------ | -------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| payload.model      | string | Yes       | Specify model, support cosyvoice-v2 (recommended), cosyvoice-v1. v1 and v2 are the same in encoding, but when using, ensure that model and voice parameters match: v2 model can only be paired with v2 voice, v1 model can only be paired with v1 voice. |
| payload.parameters | Object | Yes       | Voice configuration. Some common parameters are referenced in the table below.                                                                                                                              |

payload.parameters Some common parameters:

| Parameter Name | Type   | Required | Description                                                                                                                                                                                                                        |
| ------ | ------ | -------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| voice  | string | Yes       | Specify the voice used for speech synthesis. Please refer to [Voice List](https://help.aliyun.com/zh/model-studio/cosyvoice-websocket-api?spm=a2c4g.11186623.help-menu-2400256.d_2_5_0_2.3edf33b47WqNcp#fbe0209896w38)                                       |
| volume | int    | No       | Volume, range: 0~100, default: 50                                                                                                                                                                                        |
| rate   | float  | No       | Speech rate, range: 0.5~2. <ul><li>0.5：表示默认语速的0.5倍速。</li><li>1：表示默认语速。默认语速是指模型默认输出的合成语速，语速会依据每一个音色略有不同，约每秒钟4个字。</li><li>2：表示默认语速的2倍速。</li></ul> |
| pitch  | float  | No       | Speech pitch, range: 0.5~2, default: 1.0.                                                                                                                                                                              |

**Parameter Example**

```json
"TTS": {
  "Vendor": "CosyVoice",//Required
  "Params": {//Required
    "app": {//Required
      "api_key": "zego_test"//Required
    },
    "payload": {//Required
      "model": "cosyvoice-v2",//Required
      "parameters": {//Required
        "voice": "longxiaochun_v2",//Required
        //"volume": 50,
        //"rate": 1,
        //"pitch": 1
      }
    }
  }
}
```

</Tab>
<Tab title="ByteDance">

**app Parameters Description**

| Parameter Name  | Type   | Required | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| ------- | ------ | -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| appid   | string | Yes       | Please refer to the Volcano Engine documentation [Voice Technology - Quick Start - Control Console Usage FAQ](https://www.volcengine.com/docs/6561/196768#q1%EF%BC%9A%E5%93%AA%E9%87%8C%E5%8F%AF%E4%BB%A5%E8%8E%B7%E5%8F%96%E5%88%B0%E4%BB%A5%E4%B8%8B%E5%8F%82%E6%95%B0appid%EF%BC%8Ccluster%EF%BC%8Ctoken%EF%BC%8Cauthorization-type%EF%BC%8Csecret-key-%EF%BC%9F) "Where can I get the following parameters appid, cluster, token, authorization_type, secret_key ？" section. <br/><br/><Note title="Note">During the test period (within 2 weeks after the AI Agent service is enabled), you can set the parameter value to "zego_test" to use this service.</Note> |
| token   | string | Yes       | Please refer to the Volcano Engine documentation [Voice Technology - Quick Start - Control Console Usage FAQ](https://www.volcengine.com/docs/6561/196768#q1%EF%BC%9A%E5%93%AA%E9%87%8C%E5%8F%AF%E4%BB%A5%E8%8E%B7%E5%8F%96%E5%88%B0%E4%BB%A5%E4%B8%8B%E5%8F%82%E6%95%B0appid%EF%BC%8Ccluster%EF%BC%8Ctoken%EF%BC%8Cauthorization-type%EF%BC%8Csecret-key-%EF%BC%9F) "Where can I get the following parameters appid, cluster, token, authorization_type, secret_key ？" section. <br/><br/><Note title="Note">During the test period (within 2 weeks after the AI Agent service is enabled), you can set the parameter value to "zego_test" to use this service.</Note> |
| cluster | string | Yes       | Volcano Engine cluster configuration. Default must use "volcano_tts". Please refer to [Voice Cloning Voice](/aiagent-server/best-practices/clone-voice) for voice cloning.                                                                                                                                                                                                                                                                                                                                                                                                         |

**Other Parameters Description**

Below are only some common parameters之一 `audio` and some sub-parameters, for more other parameters, please refer to the parameter description in the [Large Model Voice Synthesis API - Parameter List - Request Parameters](https://www.volcengine.com/docs/6561/1257584#%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0) section

<Note title="Note">Note that the parameter description in the Volcano Engine documentation has **hierarchy**, not all are flat relationships.</Note>

| Parameter Name               | Type   | Required | Description                                           |
| -------------------- | ------ | -------- | ---------------------------------------------- |
| audio.voice_type     | string | Yes       | Voice type                                       |
| audio.speed_ratio    | float  | No       | Speech rate. [0.8,2]，default: 1，usually keep one decimal place. |
| audio.loudness_ratio | float  | No       | Volume. [0.5,2]，default: 1，usually keep one decimal place. |

**Parameter Example**

```json
/*
    cluster Configuration Description:
    Default: volcano_tts: Normal voice cluster
          volcano_mega： Voice Cloning Large Model 1.0
          volcano_icl： Voice Cloning Large Model 2.0
*/
"TTS": {
  "Vendor": "Bytedance",//Required
  "Params": {//Required
    "app": {//Required
      "appid": "zego_test",//Required
      "token": "zego_test",//Required
      "cluster": "volcano_tts"//Required
    },
    "audio": {//Required
      "voice_type": "zh_female_yuanqinvyou_moon_bigtts",//Required
      //"speed_ratio": 1,
      //"loudness_ratio": 1
    }
  }
}
```

</Tab>
<Tab title="ByteDanceFlowing">

**app Parameters Description**

| Parameter Name      | Type   | Required | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| ----------- | ------ | -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| appid       | string | Yes       | Please refer to the Volcano Engine documentation [Voice Technology - Quick Start - Control Console Usage FAQ](https://www.volcengine.com/docs/6561/196768#q1%EF%BC%9A%E5%93%AA%E9%87%8C%E5%8F%AF%E4%BB%A5%E8%8E%B7%E5%8F%96%E5%88%B0%E4%BB%A5%E4%B8%8B%E5%8F%82%E6%95%B0appid%EF%BC%8Ccluster%EF%BC%8Ctoken%EF%BC%8Cauthorization-type%EF%BC%8Csecret-key-%EF%BC%9F) "Where can I get the following parameters appid, cluster, token, authorization_type, secret_key ？" section. <br/><br/><Note title="Note">During the test period (within 2 weeks after the AI Agent service is enabled), you can set the parameter value to "zego_test" to use this service.</Note> |
| token       | string | Yes       | Please refer to the Volcano Engine documentation [Voice Technology - Quick Start - Control Console Usage FAQ](https://www.volcengine.com/docs/6561/196768#q1%EF%BC%9A%E5%93%AA%E9%87%8C%E5%8F%AF%E4%BB%A5%E8%8E%B7%E5%8F%96%E5%88%B0%E4%BB%A5%E4%B8%8B%E5%8F%82%E6%95%B0appid%EF%BC%8Ccluster%EF%BC%8Ctoken%EF%BC%8Cauthorization-type%EF%BC%8Csecret-key-%EF%BC%9F) "Where can I get the following parameters appid, cluster, token, authorization_type, secret_key ？" section. <br/><br/><Note title="Note">During the test period (within 2 weeks after the AI Agent service is enabled), you can set the parameter value to "zego_test" to use this service.</Note> |
| resource_id | string | Yes       | Volcano Engine resource ID. Default must use "volc.service_type.10029". Please refer to [Voice Cloning Voice](/aiagent-server/best-practices/clone-voice) for voice cloning.                                                                                                                                                                                                                                                                                                                                                                                              |

**Other Parameters Description**

Below are only some common parameters之一 `req_params` and some sub-parameters, for more other parameters, please refer to the parameter description in the [Bidirectional Streaming WebSocket-V3-Support Clone 2.0/Mix > WebSocket Binary Protocol > Payload Request Parameters](https://www.volcengine.com/docs/6561/1329505#websocket-二进制协议) section.

| Parameter Name                                | Type   | Required | Description                                                                                   |
| ------------------------------------- | ------ | -------- | -------------------------------------------------------------------------------------- |
| req_params.speaker                    | string | Yes       | Speaker, please refer to [Speaker List](https://www.volcengine.com/docs/6561/1257544).             |
| req_params.audio_params.speech_rate   | float  | No       | Speech rate, default 0, range: [-50,100], 100 represents 2.0x speed, -50 represents 0.5x speed.                       |
| req_params.audio_params.loudness_rate | float  | No       | Volume, default 0, range: [-50,100], 100 represents 2.0x volume, -50 represents 0.5x volume (mix voice does not support). |

**Parameter Example**

```json
/*
    resource_id Configuration Description:
    Default: volc.service_type.10029,即：火山大模型语音合成
    Voice Cloning 2.0：
       volc.megatts.default（小时版）
       volc.megatts.concurr（并发版）
    ⚠️（Not supported Voice Cloning 1.0）
    ⚠️Note: speaker (voice id) and resource_id must match
*/

"TTS": {
  "vendor": "BytedanceFlowing",//Required
  "params": {//Required
    "app": {//Required
      "appid": "xxxxx",//Required
      "token": "xxxxx",//Required
      "resource_id": "volc.service_type.10029"//Required
    },
    "req_params": {
      "speaker": "zh_female_qingxinnvsheng_mars_bigtts",//Required
      //"audio_params": {
       //   "speed_ratio": 0,
       //   "loudness_ratio": 0
       //}
      }
    }
  }
}
```


</Tab>
<Tab title="MiniMax">

**app Parameters Description**

| Parameter Name  | Type   | Required | Description                                                                                                                                                                                                                                                                       |
| ------- | ------ | -------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| api_key | string | Yes       | Please refer to the MiniMax documentation [Quick Start](https://platform.minimaxi.com/document/Fast%20access?key=66701cf51d57f38758d581b2) to get api key and enter it here.<br/><br/><Note title="Note">During the test period (within 2 weeks after the AI Agent service is enabled), you can set the parameter value to "zego_test" to use this service.</Note> |

**Other Parameters Description**

Below are only some common parameters, for more other parameters, please refer to the parameter description in the [Synchronous Speech Synthesis (T2A) > HTTP Interface Description > Interface Parameter Description](https://platform.minimaxi.com/document/T2A%20V2?key=66719005a427f0c8a5701643#PxNsxKPXzZqmI7zIc3O2Wy63) section.
| Parameter Name                 | Type   | Required | Description                                                                                                                                                                    |
| ---------------------- | ------ | -------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| model                  | string | Yes       | Request model version: speech-2.5-hd-preview、speech-2.5-turbo-preview、speech-02-hd、speech-02-turbo、speech-01-hd、speech-01-turbo、speech-01-240228、speech-01-turbo-240228 |
| voice_setting          | Object | Yes       | Voice configuration. Some common parameters are referenced in the table below.                                                                                                                                    |

voice_setting 部分常用参数:

| Parameter Name   | Type   | Required | Description                                                                                                                                                                                 |
| -------- | ------ | -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| voice_id | string | Yes       | Request voice id. Please refer to [Synchronous Speech Synthesis (T2A) > HTTP Interface Description > Interface Parameter Description](https://platform.minimaxi.com/document/T2A%20V2?key=66719005a427f0c8a5701643#PxNsxKPXzZqmI7zIc3O2Wy63) |
| speed    | string | No       | Speech rate, optional, the larger the value, the faster the speech speed. Range [0.5,2], default value is 1.0.                                                                                                                 |
| vol      | string | No       | Volume, optional, the larger the value, the higher the volume. Range (0,10], default value is 1.0.                                                                                                                 |
| pitch    | string | No       | Speech pitch, optional, (0 is the original voice output, the value needs to be an integer). Range [-12,12], default value is 0.                                                                                                     |

**Parameter Example**

```json
"TTS": {
  "Vendor": "Minimax",//Required
  "Params": {//Required
    "app": {//Required
      //"group_id": "xxxx",
      "api_key": "zego_test"//Required
    },
    "model": "speech-02-turbo-preview",//Required
    "voice_setting": {//Required
      "voice_id": "female-shaonv",//Required
      //"speed": 1,
      //"vol": 1,
      //"pitch": 0
    }
  }
}
```

</Tab>
</Tabs>

---

### FilterText Parameters Description

FilterText is an Object array. Each Object contains two string type parameters: BeginCharacters and EndCharacters.

| Parameter Name          | Type   | Required | Description                                                               |
| --------------- | ------ | -------- | ------------------------------------------------------------------ |
| BeginCharacters | string | Yes       | The starting punctuation of the filtered text. For example, if you want to filter the content in (), set it to (. |
| EndCharacters   | string | Yes       | The ending punctuation of the filtered text. For example, if you want to filter the content in (), set it to ). |
