# 创建会话
---

##  描述

本接口可用于为指定用户创建一个会话并配置智能体（Agent），用于后续进行 IM 与 RTC 对话。

## 接口原型

- 请求方法：POST
- 请求地址：`https://aigc-chat-api.zegotech.cn?Action=CreateConversation`
- 传输协议：HTTPS
- 调用频率限制：10 次/秒

## 请求参数

<Note title="说明">
下列 ID 类参数，包括 ConversationId、UserId、AgentId、AgentTemplateId 等，应当遵循以下规则：
- AgentId 的字符限制：数字、英文字符、'-'、'_'、'@'。
- 其它 ID 类参数的字符限制：数字、英文字符、'-'、'_'。
- 长度上限：
  - ConversationId、AgentTemplateId：128 字节。
  - UserId、AgentId：32 字节。
</Note>

| 参数               | 类型   | 是否必选 | 描述                                                                                                                                   |
|------------------|------|------|--------------------------------------------------------------------------------------------------------------------------------------|
| ConversationId   | String | 是    | 会话的唯一标识。需要保证全局唯一。                                                                                                               |
| UserId           | String | 是    | 用户 ID。                                                                                                                              |
| AgentId          | String | 是    | 智能体 ID，用于智能体登录 IM 或 RTC，必须以`@RBT#` 开头。<Note title="说明">请保证 AgentId 在同一 AppID 下唯一。</Note>                                                              |
| AgentTemplateId  | String | 否    | 智能体模版 ID，对应一个智能体配置。如需了解您可用的模版 ID，请参考 [查询模板](./../Template/Describe%20Custom%20Agent%20Template.mdx)。 <Note tiIDstle="说明">至少提供以下参数：`AgentTemplateId` 或 `CustomAgentConfig`</Note>                                           |
| ChatHistoryMode  | Number    | 否    | 是否保存会话历史消息，历史消息会作为上下文输入给 LLM。可用值如下：<ul><li>0：（默认）保存会话历史消息至 [ZIM](https://doc-zh.zego.im/zim-android/introduction/overview)（您需要自行 [集成 ZIM SDK](https://doc-zh.zego.im/zim-android/send-and-receive-messages) 注册用户或者调用 ZIM 服务端接口 [注册用户](https://doc-zh.zego.im/zim-server/user/batch-register-users)）。</li><li>1：保存会话历史消息至 ZIM（ZEGO 实时互动 AI Agent 服务端会自动注册 ZIM 用户）。</li><li>2：不保存会话历史消息。</li></ul> |
| CustomAgentConfig| Object | 否    | 自定义智能体参数，本参数结构，请见 [常用参数说明 - CustomAgentConfig](./../Common%20Parameter%20Description.mdx#customagentconfig)。若 `AgentTemplateId` 不为空，则在该模版基础上，根据本参数所传内容做修改。                  |
| ChatConfig       | Object | 否    | 对话配置，本参数结构，请见 [常用参数说明 - ChatConfig](./../Common%20Parameter%20Description.mdx#chatconfig)。              |

## 请求示例

- 请求地址 URL：

```https
https://aigc-chat-api.zegotech.cn?Action=CreateConversation
&<公共请求参数>
```

- 请求消息体：
```json
{
  "ConversationId": "test_conversation_001",
  "UserId": "test_user_001",
  "AgentId": "@RBT#test_agent_001",
  "AgentTemplateId": "template_001",
  "ChatHistoryMode": 1,
  "CustomAgentConfig": {
    "Name": "AI助手",
    "Avatar": "https://example.com/avatar.png",
    "Intro": "我是一个AI助手",
    "System": "你是一个专业的AI助手",
    "LLM": {
      "Type": "WenXin",
      "Model": "ERNIE-Bot-4",
      "IgnoreBracketText": [1]
    },
    "TTS": {
      "Type": "Aliyun",
      "Voice": "xiaogang",
      "IgnoreBracketText": [1, 2],
      "SilenceDuration": 500
    }
  },
  "ChatConfig": {
    "LLMSystemMode": 0,
    "EnableLLMServerMessage": 0
  }
}
```

## 响应参数

| 参数 | 类型 | 描述 |
|------|------|------|
| Code | Number | 返回码。0 表示成功，其他值表示失败。如需了解错误码及响应处理建议，请参考 [返回码](./../Return%20codes.mdx)。 |
| Message | String | 请求结果的说明信息。 |
| RequestId | String | 请求 ID。 |

## 响应示例

```json
{
    "Code": 0,
    "Message": "Succeed",
    "RequestId": "1843985617336143872",
    "Data": null
}
```


