# 设定视频质量

- - -

## 1 功能简介

@@@Common_Video_Configuration_Function_Introduction@@@

## 2 示例源码下载

请参考 [下载示例源码\|_blank](!DownloadDemo/DownloadDemo) 获取源码。

相关源码请查看 “/ZegoExpressExample/CommonFeatures/src/main/java/im/zego/commonvideoconfig” 目录下的文件。

## 3 前提条件

在设置视频配置之前，请确保：

@@@Express-Video_Prerequisites@@@

## 4 使用步骤

### 4.1 修改视频配置

- **详细参数设置**

@@@Common_Video_Configuration_Set_by_Yourself@@@

```java

ZegoVideoConfig videoConfig = new ZegoVideoConfig();

videoConfig.captureHeight = 640;
videoConfig.captureWidth = 360;
videoConfig.encodeHeight = 640;
videoConfig.encodeWidth = 360;
videoConfig.fps = 15
videoConfig.bitrate = 600;

// 设置视频配置
ZegoExpressEngine.getEngine().setVideoConfig(videoConfig);
```

<div class="mk-hint">

移动端的宽高分辨率与 PC 端的宽高分辨率是相反的，例如移动端 360p 的分辨率为 360x640，而 PC 端 360p 的分辨率为 640x360。
</div>

- **使用预设值设置**

@@@Common_Video_Configuration_Use_Preset_Values@@@

使用预设值时示例代码如下：

```java
ZegoVideoConfig videoConfig = new ZegoVideoConfig(ZegoVideoConfigPreset.PRESET_1080P);
ZegoExpressEngine.getEngine().setVideoConfig(videoConfig);
```

### 4.2 修改视频视图模式

<div class="mk-warning">

设置视频视图模式前需先停止预览或停止拉流，否则无法生效。

</div>

通过修改视图对象 [ZegoCanvas\|_blank](@-ZegoCanvas) 的 “viewMode” 参数可以修改视频的视图模式。目前支持三种视频渲染填充模式:

|枚举值|说明|
|-|-|
|ASPECT_FIT|等比缩放，可能有黑边。|
|ASPECT_FILL|等比缩放填充整个 View，可能有部分被裁减。|
|SCALE_TO_FILL|填充整个 View，图像可能被拉伸。|

三种视频渲染填充模式效果如图所示：

![](/Pics/Android/CommonFeatures/CommonVideoConfig/viewMode_android.png)

<div class = 'mk-hint'>

- 上图中展示的视图的分辨率为 320 x 390（宽 x 高），视频分辨率为 340 x 340（宽 x 高）。
- 上图中原视频尺寸高等于宽，视图尺寸高大于宽，故在 “ASPECT_FIT” 渲染模式下，视频上下出现黑边；若此时视图尺寸宽大于高，则在 “ASPECT_FIT” 渲染模式下，视频左右将会出现黑边。
</div>

以设置预览视图模式为 “ASPECT_FIT” 并开始预览为例：

```java
// preview 为 UI 界面上的 SurfaceView/TextureView/SurfaceTexture 对象
previewCanvas = new ZegoCanvas(preview);
// 将视图模式设置为 ASPECT_FIT
previewCanvas.viewMode = ZegoViewMode.ASPECT_FIT;
// 开始预览
engine.startPreview(previewCanvas);
```

### 4.3 设置镜像模式

<div class="mk-hint">

支持在推流前后设置并即时生效。
</div>

你可以调用 [setVideoMirrorMode\|_blank](@setVideoMirrorMode) 设置本地预览视频以及推送的视频是否开启镜像模式。目前支持如下四种镜像模式：

|枚举值|说明|
|-|-|
|NO_MIRROR|本地预览和拉流端看到的视频都不是镜像画面。|
|ONLY_PREVIEW_MIRROR|只有本地预览时才是镜像画面，默认采用此模式。|
|ONLY_PUBLISH_MIRROR|只有拉流端看到的视频才是镜像画面。|
|BOTH_MIRROR|本地预览和拉流端看到的视频都是镜像画面。|

四种镜像模式的效果如下：

![](/Pics/Android/CommonFeatures/CommonVideoConfig/mirror_mode_android.png)

以设置拉流端镜像显示，设置本地预览非镜像显示为例：

```java
engine.setVideoMirrorMode(ZegoVideoMirrorMode.ONLY_PUBLISH_MIRROR);
```


## 相关文档

- [如何选择视频分辨率、帧率、码率？\|_blank](https://doc-zh.zego.im/faq/video_info)
- [怎么处理视频放大或黑边问题？\|_blank](https://doc-zh.zego.im/faq/video_big)
- [怎么处理视频模糊问题？\|_blank](https://doc-zh.zego.im/faq/video_blur)
