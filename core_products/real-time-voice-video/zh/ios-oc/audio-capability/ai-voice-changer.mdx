---
articleID: 18299
---
# AI 变声

- - -

@@@AI_VoiceChanger_intro@@@

## 前提条件

在实现 AI 变声功能之前，请确保：

@@@Express-Video_Prerequisites@@@


## 使用步骤

开发者可以按照以下步骤完成 AI 变声的相关设置：

### 1 开启权限

请确认您已联系 ZEGO 技术支持进行特殊编包，并开启了 AI 变声权限。

### 2 初始化和登录房间

初始化和登录房间的具体流程，请参考实现视频通话文档中的 “[3.1 创建引擎](!Integration/Solution_Implementation#initialization)” 及 “[3.2 登录房间](!Integration/Solution_Implementation#createroom)”。

### 3 初始化 AI 变声引擎实例

1. 调用 [createAIVoiceChanger](@createAIVoiceChanger) 接口，创建 AI 变声引擎实例。

    当前只支持同时创建一个实例，调用 [destroyAIVoiceChanger](@destroyAIVoiceChanger) 接口销毁实例之前，再次创建将返回 nil。

    ```objc
    // 创建 AI 变声引擎实例
    self.aiVoiceChanger = [[ZegoExpressEngine sharedEngine] createAIVoiceChanger];
    ```

2. 调用 [ZegoAIVoiceChanger.setEventHandler](@setEventHandler-ZegoAIVoiceChanger) 接口，设置 AI 变声引擎事件回调。

    ```objc
    // 设置 AI 变声引擎事件回调
    [self.aiVoiceChanger setEventHandler:self];
    ```

3. 调用 [ZegoAIVoiceChanger.initEngine](@initEngine-ZegoAIVoiceChanger) 接口，初始化 AI 变声引擎实例。

    <div class = "mk-warning">

    [ZegoAIVoiceChanger.initEngine](@initEngine-ZegoAIVoiceChanger) 接口需要在 [startPublishingStream](@startPublishingStream) 接口之前调用才有效。
    </div>

    ```objc
    // 初始化 AI 变声引擎
    [self.aiVoiceChanger initEngine];
    ```

### 4 更新 AI 变声引擎模型

调用 [ZegoAIVoiceChanger.update](@update-ZegoAIVoiceChanger) 接口，更新 AI 变声引擎模型。**AI 变声引擎模型文件较大，首次更新时耗时会比较长，请您耐心等待。**

```objc
// 更新 AI 变声引擎模型
[self.aiVoiceChanger update];
```

### 5 获取音色列表

调用 [ZegoAIVoiceChanger.getSpeakerList](@getSpeakerList-ZegoAIVoiceChanger) 接口，获取可用音色列表。

可用音色列表将通过 [ZegoAIVoiceChangerEventHandler.onGetSpeakerList](/article/api?doc=Express_Video_SDK_API~objective-c_ios~class~ZegoAIVoiceChangerEventHandler#ai-voice-changer-on-update) 回调接口返回。

```objc
// 获取可用音色列表
[self.aiVoiceChanger getSpeakerList];
```

### 6 设置目标音色

调用 [ZegoAIVoiceChanger.setSpeaker](@setSpeaker-ZegoAIVoiceChanger) 接口，设置音色，音色的选择可以通过 [5 获取音色列表](!AI_VoiceChanger#3_5) 获取。

设置音色 ID 为 0 时，表示使用原声。

```objc
// 设置音色
int speakerID = 0; // 音色 ID
[self.aiVoiceChanger setSpeaker:speakerID];
```

### 7 销毁 AI 变声引擎实例

功能使用结束后，调用 [destroyAIVoiceChanger](@destroyAIVoiceChanger) 接口，销毁 AI 变声引擎实例，释放麦克风等资源。

```objc
// 销毁 AI 变声引擎实例
[[ZegoExpressEngine sharedEngine] destroyAIVoiceChanger:self.aiVoiceChanger];
```

## 常见问题

1. **在编译工程时，如果出现类似 “Undefined symbol” 的错误，该如何处理？**

    ```objc
    Undefined symbol:
    _$s10ObjectiveC8ObjCBoolVMn
    ```

   出现如上报错时，您可以通过在您的项目工程目录中，添加一个空白的以 `.swift` 结尾的文件，重新编译即可。
