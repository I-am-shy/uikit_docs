@@@ServerAPIWarning@@@

# 单流转码开始回调

- - -

## 1 描述

当开发者需要了解当前 App 的单流转码任务，可以参考 [回调配置说明\](!Callback/Configuration_Instructions) 配置相关回调接口。当发起 [开始单流转码\](!Start_single_stream_transcoding) 请求成功后，可以通过该回调，查看转码任务的结果。

## 2 回调说明

- 请求方法：POST。

@@@Server_API2_callback_intro_1@@@

- 请求地址：请联系 ZEGO 技术支持配置回调地址。
- 传输协议：HTTPS/HTTP，建议使用 HTTPS。

## 3 回调参数

<table class="collapsible-table" >
  <colgroup>
    <col width="30%">
    <col width="15%">
    <col width="55%">
  </colgroup>
<tbody><tr data-row-level="1">
<th>公共参数</th>
<th>类型</th>
<th>描述</th>
</tr>
<tr data-row-level="2">
<td>Event</td>
<td>String</td>
<td>回调事件，此回调返回值为 <code>transcode_start</code>。</td>
</tr>
<tr data-row-level="3">
<td>Appid</td>
<td>String</td>
<td>APP 的唯一标识。</td>
</tr>
<tr data-row-level="4">
<td>Timestamp</td>
<td>String</td>
<td>服务器当前时间，Unix 时间戳。</td>
</tr>
<tr data-row-level="5">
<td>Nonce</td>
<td>String</td>
<td>随机数。</td>
</tr>
<tr data-row-level="6">
<td>Signature</td>
<td>String</td>
<td>检验串，详情见 [检验说明](!Callback/Overview)。</td>
</tr>
<tr data-row-level="7">
<th>业务参数</th>
<th>类型</th>
<th>描述</th>
</tr>
<tr data-row-level="8">
<td>TaskId</td>
<td>String</td>
<td>单流转码任务的唯一标识 ID。</td>
</tr>
<tr data-row-level="9">
<td>UserId</td>
<td>String</td>
<td>发起开始单流转码任务的用户 ID，由开发者自定义。</td>
</tr>
<tr data-row-level="10">
<td>Sequence</td>
<td>Int</td>
<td>发起转码任务的序列号。</td>
</tr>
<tr data-row-level="11">
<td>Status</td>
<td>String</td>
<td><p>转码任务的状态，返回值为：</p><ul><li>TranscodeStarted：转码任务已开始。</li><li>TranscodeUpdated：转码任务已更新。</li></ul></td>
</tr>
<tr data-row-level="12" data-row-child="true">
<td>Details</td>
<td>Object</td>
<td>转码任务的详细信息。</td>
</tr>
<tr data-row-level="12-1" data-row-child="true">
<td>Input</td>
<td>Object</td>
<td>转码任务的输入流信息。</td>
</tr>
<tr data-row-level="12-1-1">
<td>StreamId</td>
<td>String</td>
<td>转码输入流 ID。</td>
</tr>
<tr data-row-level="12-1-2">
<td>StreamUrl</td>
<td>String</td>
<td>转码输入流 Url。</td>
</tr>
<tr data-row-level="12-2" data-row-child="true">
<td>Outputs</td>
<td>Array of Object</td>
<td>转码任务的输出流信息。</td>
</tr>
<tr data-row-level="12-2-1">
<td>StreamId</td>
<td>String</td>
<td>转码输出流 ID。</td>
</tr>
<tr data-row-level="12-2-2">
<td>StreamUrl</td>
<td>String</td>
<td>转码输出流 Url。</td>
</tr>
<tr data-row-level="12-2-3">
<td>VideoEncId</td>
<td>Int</td>
<td>转码输出流的视频编码格式。</td>
</tr>
<tr data-row-level="12-2-4">
<td>VideoBitrate</td>
<td>Int</td>
<td>转码输出流的码率。</td>
</tr>
<tr data-row-level="12-2-5">
<td>ShortEdgeAdaption</td>
<td>Int</td>
<td>转码输出流的分辨率是否按照短边设置自适应横竖屏。</td>
</tr>
<tr data-row-level="12-2-6">
<td>Fps</td>
<td>Int</td>
<td>转码输出流的帧率。</td>
</tr>
<tr data-row-level="12-2-7">
<td>Width</td>
<td>Int</td>
<td>转码输出流的分辨率（宽）。</td>
</tr>
<tr data-row-level="12-2-8">
<td>Height</td>
<td>Int</td>
<td>转码输出流的分辨率（高）。</td>
</tr>
<tr data-row-level="12-2-9">
<td>GOP</td>
<td>Int</td>
<td>转码输出流的关键帧间隔。</td>
</tr>
</tbody></table>


## 4 数据示例

```json
{
    "Event": "transcode_start",
    "Appid": "111111",
    "Timestamp": "timestamp",
    "Nonce": "nonce",
    "Signature": "signature",
    "TaskId": "2222",
    "UserId": "2222",
    "Sequence": 0,
    "Status": "TranscodeStarted",
    "Details": {
        "Input": {
            "StreamId": "2222"
        },
        "Outputs": [
            {
                "StreamId": "2222",
                "VideoEncId": 0,
                "Fps": 0,
                "ShortEdgeAdaption": 0,
                "Width": 1280,
                "Height": 720,
                "VideoBitrate": 0,
                "GOP": 2
            }
        ]
    }
}
```

## 5 返回响应

返回 HTTP status code 为 2XX （例如 200）表示成功，其他响应都表示失败。


## 6 回调重试策略

@@@Server_API2_callback@@@
