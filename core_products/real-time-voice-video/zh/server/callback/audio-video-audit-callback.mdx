@@@ServerAPIWarning@@@

# 音频流审核回调

---

## 1 描述

当开发者有音频流内容审核的需求时，在 [开始音频流审核\|_blank](!Interface_audit/Start_audio_audit) 任务后，将会以 POST 的形式对回调地址进行请求，获取音频流审核识别结果。当 [开始音频流审核\|_blank](!Interface_audit/Start_audio_audit) 任务中的 `ReturnFinishInfo` 参数为 1 时，审核任务结束后，会发起审核任务状态回调。

## 2 回调说明

- 请求方法：POST。

@@@Server_API2_callback_intro_1@@@

- 请求地址：请参考 [控制台 - 云市场 - 数美内容审核\|_blank](#18891)，按照页面指引，完成相关回调地址的配置。
- 传输协议：HTTPS/HTTP，建议使用 HTTPS。

## 3 回调参数

### 3.1 审核结果回调

<table class="collapsible-table" >
  <colgroup>
    <col width="30%">
    <col width="20%">
    <col width="50%">
  </colgroup>
<tbody><tr data-row-level="1">
<th>公共参数</th>
<th>类型</th>
<th>描述</th>
</tr>
<tr data-row-level="2">
<td>Event</td>
<td>String</td>
<td>回调事件，此回调返回值为 `censor_audio_v2_result`。</td>
</tr>
<tr data-row-level="3">
<td>AppId</td>
<td>Number</td>
<td>AppID。</td>
</tr>
<tr data-row-level="4">
<td>Timestamp</td>
<td>Number</td>
<td>服务器当前时间，Unix 时间戳（秒）。</td>
</tr>
<tr data-row-level="5">
<td>Nonce</td>
<td>String</td>
<td>随机数。</td>
</tr>
<tr data-row-level="6">
<td>Signature</td>
<td>String</td>
<td>签名，具体见&nbsp; <a target="_blank" href="!Callback/Overview">检验说明</a>。</td>
</tr>
<tr data-row-level="7">
<th>业务参数</th>
<th>类型</th>
<th>描述</th>
</tr>
<tr data-row-level="8">
<td>Code</td>
<td>Number</td>
<td>返回码。<br>0 为成功。</td>
</tr>
<tr data-row-level="9">
<td>Message</td>
<td>String</td>
<td>操作结果描述。</td>
</tr>
<tr data-row-level="10">
<td>TaskId</td>
<td>String</td>
<td>审核任务的 TaskId。<br>对应 [开始音频流审核|_blank](!Interface_audit/Start_audio_audit) 中响应参数中返回的 TaskId。</td>
</tr>
<tr data-row-level="11">
<td>ResultTaskId</td>
<td>String</td>
<td>此次回调信息的 ID。</td>
</tr>
<tr data-row-level="12" data-row-child="true">
<td>Detail</td>
<td>Object</td>
<td>10s 片段的审核结果详情。</td>
</tr>
<tr data-row-level="12-1">
<td>RiskLevel</td>
<td>String</td>
<td>风险级别（code 为 0 时存在）。<br>开发者可以根据该值对违规片段对应的音频流和用户进行相应处理。<br>注意：该字段将返回的 10s 音频中，风险程度最高的“风险类型列表”（比如“涉政”通常风险程度更高），具体“风险类型列表”的风险程度优先级由数美审核内部决定。
- PASS：正常内容，建议直接放行。
- REVIEW：可疑内容，建议人工审核。
- REJECT：违规内容，建议直接拦截。</td>
</tr>
<tr data-row-level="12-2">
<td>AudioText</td>
<td>String</td>
<td>10s 音频片段对应的语义文本。</td>
</tr>
<tr data-row-level="12-3">
<td>AudioUrl</td>
<td>String</td>
<td>10s 音频片段的 URL。</td>
</tr>
<tr data-row-level="12-4">
<td>PreAudioUrl</td>
<td>String</td>
<td>仅当开始审核任务请求的参数 ReturnPreAudio=1 时，该参数有值，表示当前违规音频片段 + 前一个音频片段的 20s 音频片段的 URL 地址。</td>
</tr>
<tr data-row-level="12-5">
<td>RiskDescription</td>
<td>String</td>
<td>当前 10s 片段中，风险程度最高的违规内容的具体“风险类型列表”及细分类别。<br>将按照详细程度分为，一级标签，二级标签及三级标签。<br>注意：仅供人了解风险原因时作为参考，请勿依赖该参数的值做逻辑处理。<br>
- RiskLevel 为 PASS 时，返回 “正常”。
- 命中自定义名单时，返回自定义名单名称。
- 其他情况展现形式为：一级标签：二级标签：三级标签。</td>
</tr>
<tr data-row-level="12-6">
<td>RiskLabel1</td>
<td>String</td>
<td>一级标签。<br>RiskLevel 为 PASS 时，返回 “normal”。</td>
</tr>
<tr data-row-level="12-7">
<td>RiskLabel2</td>
<td>String</td>
<td>二级标签。<br>二级标签归属于一级标签，当 riskLevel 为 PASS 时为空。</td>
</tr>
<tr data-row-level="12-8">
<td>RiskLabel3</td>
<td>String</td>
<td>三级标签。<br>三级标签归属于二级标签，当 riskLevel 为 PASS 时为空。</td>
</tr>
<tr data-row-level="12-9">
<td>VadStatus</td>
<td>Number</td>
<td>音频片段的静音状态：
- 0 ：静音片段。为静音片段时，其他部分字段将返回空，以实际回调内容为准。
- 1 ：非静音片段。</td>
</tr>
<tr data-row-level="12-10" data-row-child="true">
<td>RiskDetail</td>
<td>Object</td>
<td>风险详情。<br>将展示 10s 片段中，风险程度最高的风险信息。例如当前 10s 片段命中“色情”和“涉政”两个“风险类型列表”，后台判定“涉政”的风险程度高于“色情”，则当前将返回“涉政”相关的风险详情。</td>
</tr>
<tr data-row-level="12-10-1">
<td>RiskSource</td>
<td>Number</td>
<td>风险来源：
- 1000：无风险。
- 1001：音频语义。
- 1003：音频特征（如：音调、音色、声纹、旋律等）。</td>
</tr>
<tr data-row-level="12-10-2">
<td>AudioText</td>
<td>String</td>
<td>10s 音频语义转译的文本。</td>
</tr>
<tr data-row-level="12-10-3" data-row-child="true">
<td>MatchedLists</td>
<td>Array of Object</td>
<td>命中的自定义名单（由开发者联系技术支持进行配置）。</td>
</tr>
<tr data-row-level="12-10-3-1">
<td>Name</td>
<td>String</td>
<td>自定义名单名称。</td>
</tr>
<tr data-row-level="12-11" data-row-child="true">
<td>RiskInfoList</td>
<td>Array of Object</td>
<td>10s 音频片段中，所有存在风险的信息列表。<br>按照数美内部自定义的风险程度优先级，由大到小进行排序。</td>
</tr>
<tr data-row-level="12-11-1">
<td>RiskLevel</td>
<td>Number</td>
<td>风险级别（code 为 0 时存在）。<br>开发者可以根据该值对违规片段对应的音频流和用户进行相应处理。
- PASS：正常内容，建议直接放行。
- REVIEW：可疑内容，建议人工审核。
- REJECT：违规内容，建议直接拦截。</td>
</tr>
<tr data-row-level="12-11-2">
<td>RiskDescription</td>
<td>String</td>
<td>当前 10s 片段中，风险程度最高的违规内容的具体“风险类型列表”及细分类别。<br>将按照详细程度分为，一级标签，二级标签及三级标签。<br>注意：仅供人了解风险原因时作为参考，请勿依赖该参数的值做逻辑处理。<br>
- RiskLevel 为 PASS 时，返回 “正常”。
- 命中自定义名单时，返回自定义名单名称。
- 其他情况展现形式为：一级标签：二级标签：三级标签。</td>
</tr>
<tr data-row-level="12-11-3">
<td>RiskLabel1</td>
<td>String</td>
<td>一级标签。<br>RiskLevel 为 PASS 时，返回 “normal”。</td>
</tr>
<tr data-row-level="12-11-4">
<td>RiskLabel2</td>
<td>String</td>
<td>二级标签。<br>二级标签归属于一级标签，当 riskLevel 为 PASS 时为空。</td>
</tr>
<tr data-row-level="12-11-5">
<td>RiskLabel3</td>
<td>String</td>
<td>三级标签。<br>三级标签归属于二级标签，当 riskLevel 为 PASS 时为空。</td>
</tr>
<tr data-row-level="12-11-6" data-row-child="true">
<td>RiskDetail</td>
<td>Object</td>
<td>风险详情，将展示 10s 片段中，风险程度最高的风险信息。<br>例如当前 10s 片段命中“色情”和“涉政”两个“风险类型列表”，后台判定“涉政”的风险程度高于“色情”，则当前将返回“涉政”相关的风险详情。</td>
</tr>
<tr data-row-level="12-11-6-1">
<td>RiskSource</td>
<td>Number</td>
<td>风险来源：
- 1000：无风险。
- 1001：音频语义。
- 1003：音频特征（如：音调、音色、声纹、旋律等）。</td>
</tr>
<tr data-row-level="12-11-6-2">
<td>AudioText</td>
<td>String</td>
<td>10s 音频语义转译的文本。
仅风险程度最高的风险信息此字段有值。</td>
</tr>
<tr data-row-level="12-11-6-3" data-row-child="true">
<td>MatchedLists</td>
<td>Array of Object</td>
<td>命中的自定义名单（由开发者联系技术支持进行配置）。</td>
</tr>
<tr data-row-level="12-11-6-3-1">
<td>Name</td>
<td>String</td>
<td>自定义名单名称。</td>
</tr>
<tr data-row-level="12-12" data-row-child="true">
<td>BusinessInfoList</td>
<td>Array of Object</td>
<td>所有业务信息列表。
若以下字段无法满足您的需求，可联系技术支持进行调整。</td>
</tr>
<tr data-row-level="12-12-1">
<td>BusinessDescription</td>
<td>String</td>
<td>业务标签中文描述。<br>
格式为"一级业务标签:二级业务标签:三级业务标签"的中文名称，如人像:人像姿态:坐姿。</td>
</tr>
<tr data-row-level="12-12-2">
<td>BusinessLabel1</td>
<td>String</td>
<td>一级业务标签。</td>
</tr>
<tr data-row-level="12-12-3">
<td>BusinessLabel2</td>
<td>String</td>
<td>二级业务标签。</td>
</tr>
<tr data-row-level="12-12-4">
<td>BusinessLabe3</td>
<td>String</td>
<td>三级业务标签。</td>
</tr>
<tr data-row-level="13" data-row-child="true">
<td>AuxInfo</td>
<td>Object</td>
<td>辅助信息。</td>
</tr>
<tr data-row-level="13-13">
<td>RoomId</td>
<td>String</td>
<td>审核的房间 ID。</td>
</tr>
<tr data-row-level="13-14">
<td>ProcessBeginTime</td>
<td>Number</td>
<td>10s 音频开始审核的时间（13 位 Unix 时间戳）。</td>
</tr>
<tr data-row-level="13-15">
<td>ProcessFinishTime</td>
<td>Number</td>
<td>10s 音频结束审核的时间（13 位 Unix 时间戳）。</td>
</tr>
</tbody></table>

### 3.2 审核任务状态回调

当 [开始音频流审核\|_blank](!Interface_audit/Start_audio_audit) 任务中的 `ReturnFinishInfo` 参数为 1 时，音频流审核任务结束后，会发起审核任务状态回调。

<table class="collapsible-table" >
  <colgroup>
    <col>
    <col>
    <col>
  </colgroup>
<tbody><tr data-row-level="1">
<th>公共参数</th>
<th>类型</th>
<th>描述</th>
</tr>
<tr data-row-level="2">
<td>Event</td>
<td>String</td>
<td>回调事件，此回调返回值为 `censor_audio_v2_status`。</td>
</tr>
<tr data-row-level="3">
<td>AppId</td>
<td>Number</td>
<td>AppID。</td>
</tr>
<tr data-row-level="4">
<td>Timestamp</td>
<td>Number</td>
<td>服务器当前时间，Unix 时间戳（秒）。</td>
</tr>
<tr data-row-level="5">
<td>Nonce</td>
<td>String</td>
<td>随机数。</td>
</tr>
<tr data-row-level="6">
<td>Signature</td>
<td>String</td>
<td>签名，具体见&nbsp; <a target="_blank" href="!Callback/Overview">检验说明</a>。</td>
</tr>
<tr data-row-level="7">
<th>业务参数</th>
<th>类型</th>
<th>描述</th>
</tr>
<tr data-row-level="8">
<td>Code</td>
<td>Number</td>
<td>返回码，0 表示成功。</td>
</tr>
<tr data-row-level="9">
<td>Message</td>
<td>String</td>
<td>操作结果描述。</td>
</tr>
<tr data-row-level="10">
<td>TaskId</td>
<td>String</td>
<td>审核任务的 TaskId，对应 [开始音频流审核|_blank](!Interface_audit/Start_audio_audit) 返回的 TaskId。</td>
</tr>
<tr data-row-level="11">
<td>Status</td>
<td>Number</td>
<td>审核状态。<br>0：审核结束。</td>
</tr>
<tr data-row-level="12" data-row-child="true">
<td>AuxInfo</td>
<td>Object</td>
<td>辅助信息。</td>
</tr>
<tr data-row-level="12-1">
<td>RoomId</td>
<td>String</td>
<td>房间 ID。</td>
</tr>
<tr data-row-level="12-2">
<td>CensorStreamTime</td>
<td>Number</td>
<td>本次任务审核流的总时长（单位：秒）。</td>
</tr>
</tbody></table>

## 4 数据示例


### 4.1 审核结果回调示例

```json
{
    //公共参数
    "Event": "censor_audio_v2_result",
    "AppId": 1,
    "Timestamp": 1724743250,
    "Nonce": "7407715855877898783",
    "Signature": "5cc9e67af0ba0c95f99bd73f79a36485f574ad11"
    //业务参数
    "Code": 0,
    "Message": "success",
    "TaskId": "384a8a77aeb352d3ec8144ab4640cc52",
    "ResultTaskId": "384a8a77aeb352d3ec8144ab4640cc52_2",
    "Detail": {
        "RiskLevel": "REJECT",
        "AudioText": "加个好友吧 qq12345",
        "AudioUrl": "http://xxxx/POST_AUDIOSTREAM%2FMP3%2F20240606%2F384a8a77aeb352d3ec8144ab4640cc52_2.mp3?Expires=1720269317&OSSAccessKeyId=LTAI5tLsVBxJ8nhyy5gQVW3K&Signature=8JZymbV%2F6Psm72k6S2Xq3Dcrg14%3D",
        "PreAudioUrl": "http://xxxx/POST_AUDIOSTREAM%2FMP3%2F20240606%2F384a8a77aeb352d3ec8144ab4640cc52_2_pre.mp3?Expires=1720269317&OSSAccessKeyId=LTAI5tLsVBxJ8nhyy5gQVW3K&Signature=BKUDNNWPklQldaEMSFOvSts6O84%3D",
        "RiskDescription": "广告:联系方式:联系方式",
        "RiskLabel1": "ad",
        "RiskLabel2": "lianxifangshi",
        "RiskLabel3": "lianxifangshi",
        "VadStatus": 1,
        "RiskDetail": {
            "RiskSource": 1001,
            "AudioText":  "加个好友吧 qq12345",
            "MatchedLists": null
        },
        "RiskInfoList": [
            {
                "RiskLevel": "REJECT",
                "RiskDescription": "广告:联系方式:联系方式",
                "RiskLabel1": "ad",
                "RiskLabel2": "lianxifangshi",
                "RiskLabel3": "lianxifangshi",
                "RiskDetail": {
                    "RiskSource": 1001,
                    "AudioText": "加个好友吧 qq12345",
                    "MatchedLists": null
                }
            },
            {
                "RiskLevel": "REJECT",
                "RiskDescription": "广告:联系方式:联系方式",
                "RiskLabel1": "ad",
                "RiskLabel2": "lianxifangshi",
                "RiskLabel3": "lianxifangshi",
                "RiskDetail": {
                    "RiskSource": 1001,
                    "AudioText": "加个好友吧 qq12345",
                    "MatchedLists": null
                }
            }, 
        ],
        "BusinessInfoList": [
            {
                "BusinessDescription": "语种:普通话:普通话",
                "BusinessLabel1": "language",
                "BusinessLabel2": "Chinese",
                "BusinessLabel3": "Chinese"
            }
        ]
    },
    "AuxInfo": {
        "RoomId": "room_1",
        "ProcessBeginTime": 1717677317155,
        "ProcessFinishTime": 1717677317554
    },
}
```

### 4.2 审核任务状态回调示例

```json
{
    //公共参数
    "Event": "censor_audio_v2_status",
    "AppId": 1,
    "Timestamp": 1724743250,
    "Nonce": "7407715855877898783",
    "Signature": "5cc9e67af0ba0c95f99bd73f79a36485f574ad11"
    //业务参数
    "Code": 0,
    "Message": "success",
    "TaskId": "384a8a77aeb352d3ec8144ab4640cc52",
    "Status": 0,
    "AuxInfo": {
        "RoomId": "room_1",
        "CensorStreamTime": 31
    }
}
```

## 5 返回响应

返回 HTTP status code 为 2XX （例如 200）表示成功，其他响应都表示失败。


## 6 回调重试策略

@@@Server_API2_callback@@@
