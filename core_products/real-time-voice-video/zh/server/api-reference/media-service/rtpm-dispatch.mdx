---
id: rtpm-dispatch
title: "RTMPDispatchV2"
description: "调用本接口可以发起 RTMP 推拉流调度，支持 'pull' 和 'push' 两种调度模式。"
api: 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
info_path: core_products/real-time-voice-video/zh/server/api-reference/media-service/open-api-desc
---

<h1 className={"openapi__heading"}>RTMPDispatchV2</h1>

<MethodEndpoint method={"get"} path={"/"}></MethodEndpoint>


调用本接口可以发起 RTMP 推拉流调度，支持 "pull" 和 "push" 两种调度模式。

当您需要自行通过 RTMP 协议，从 ZEGO 音视频云进行直播流的推流或拉流时，可以通过本接口获取 RTMP 的推流或拉流节点。开发者在客户端传入流 ID（StreamId）、调度模式（Type）、客户端 IP（ClientIP）和序列号（Sequence）后，ZEGO 媒体服务器（RTC 服务）返回调度结果集，供客户推拉流。

例如，当通过 OBS 等第三方推流工具进行 RTMP 推流时，需要进行推流调度；当需要第三方播放器拉 RTMP 流进行播放时，需要进行拉流调度。

<Warning title="注意">
首次使用本接口，需要联系 ZEGO 技术支持进行配置。
</Warning>
<Note title="调用频率限制">同一个 AppID 下：40 次/秒</Note>
## 旧版接口使用说明

<Accordion title="使用 RTMPDispatch 访问 ZEGO 服务端" defaultOpen="false">
<Note title="说明">

**RTMPDispatchV2（推荐）** 和 **RTMPDispatch** 的区别是，访问 ZEGO 服务端时：

- 使用的是 `RTMPDispatchV2`，ZEGO 服务端返回的 Data 数据为 URL 形式。
- 使用的是 `RTMPDispatch`，ZEGO 服务端返回的 Data 数据为 IP Port 形式。

</Note>

请求地址：`https://rtc-api.zego.im/?Action=RTMPDispatch`

响应示例：

```json
{
    "Code":0,
    "Message":"ok",
    "RequestId":"5094436160208407316",
    "Data":[
        "81.69.49.115:1935"
    ]
}
```
</Accordion>
<br/>

<Note title="说明">
测试环境下（详见 IsTest 公共参数说明），流 ID 需要加上 "zegotest-AppId-" 前缀。例如，流 ID 为 "test"，在 AppId 为 "123456789" 的测试环境下，流 ID 应为 "zegotest-123456789-test"。
</Note>

## Request
<details style={{"marginBottom":"1rem"}} className={"openapi-markdown__details"} data-collapsed={false} open={true}><summary style={{}}><h3 className={"openapi-markdown__details-summary-header-params"}>Query Parameters</h3></summary><div><ul><ParamsItem className={"paramsItem"} param={{"name":"Action","in":"query","description":"> 接口原型参数\n>\n> https://rtc-api.zego.im?Action=RTMPDispatchV2\n","required":true,"schema":{"type":"string","enum":["RTMPDispatchV2"]},"style":"form","explode":true}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"AppId","in":"query","description":"💡公共参数。AppId，ZEGO 分配的用户唯一凭证。","required":true,"schema":{"type":"integer","format":"uint32"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"SignatureNonce","in":"query","description":"💡公共参数。随机字符串。","required":true,"schema":{"type":"string"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"Timestamp","in":"query","description":"💡公共参数。Unix 时间戳，单位为秒。最多允许 10 分钟的误差。","required":true,"schema":{"type":"integer","format":"int64"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"Signature","in":"query","description":"💡公共参数。签名，用于验证请求的合法性。","required":true,"schema":{"type":"string"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"SignatureVersion","in":"query","description":"💡公共参数。签名版本号。","required":true,"schema":{"type":"string","default":"2.0","enum":["2.0"]}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"IsTest","in":"query","description":"💡公共参数。是否为测试环境。设为 true 表示使用测试环境。2021-11-16 及之前在 ZEGO 控制台创建的项目默认是测试环境，可根据业务需求设置此参数；而之后创建的项目默认是正式环境。\n","required":false,"schema":{"type":"string","enum":["true","false"],"default":"false"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"StreamId","in":"query","required":true,"schema":{"type":"string"},"description":"流 ID，长度不超过 256 的字符串。\n- 流 ID 由您自己定义。\n- 在推流时，需要在整个 AppID 内全局唯一，若出现在同一个 AppID 内，不同的用户各推了一条流且流名相同，将会导致后推流的用户推流失败。\n- 仅支持数字，英文字符 和 '-', '_'。\n"}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"Sequence","in":"query","required":true,"schema":{"type":"Int64"},"description":"请求序列号；仅用于请求对帐，推荐使用时间戳（毫秒级别）。"}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"Type","in":"query","required":true,"schema":{"type":"string"},"description":"调度模式：\n- pull：获取 RTMP 的拉流节点\n- push：获取 RTMP 的推流节点\n"}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"ClientIP","in":"query","required":false,"schema":{"type":"string"},"description":"非必选，如有，则传入客户端 IP 地址，例如：119.23.242.129。\n\n> **注意**\n>\n> 当前不支持 IPv6 格式的 IP 地址。\n"}}></ParamsItem></ul></div></details>
<div><div><ApiTabs label={undefined} id={undefined}><TabItem label={"200"} value={"200"}><div>成功</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><ul className={"response-schema-first-body-node-container"}><SchemaItem collapsible={false} name={"Code"} required={false} schemaName={"number"} qualifierMessage={undefined} schema={{"type":"integer","format":"number","description":"返回码。\n以下仅列出了接口业务逻辑相关的部分返回码，完整返回码请参考 [全局返回码](/real-time-video-server/api-reference/return-codes)。\n<table>\n  <thead>\n    <tr><th>返回码</th><th>说明</th><th>处理建议</th></tr>\n  </thead>\n  <tbody>\n    <tr><td>1010、30002</td><td>接口调用频率过高。</td><td>请降低接口请求频率。</td></tr>\n    <tr><td>1001</td><td>调度失败。</td><td>请联系 ZEGO 技术支持处理。</td></tr>\n    <tr><td>1002</td><td>推流节点为空。</td><td>请联系 ZEGO 技术支持处理。</td></tr>\n    <tr><td>1003</td><td>拉流节点为空。</td><td>请联系 ZEGO 技术支持处理。</td></tr>\n    <tr><td>1005</td><td>App 不在线。</td><td>请联系 ZEGO 技术支持处理。</td></tr>\n    <tr><td>1006</td><td>无效参数。</td><td>请联系 ZEGO 技术支持处理。</td></tr>\n    <tr><td>30003</td><td>内部错误。</td><td>请联系 ZEGO 技术支持处理。</td></tr>\n    <tr><td>30004</td><td>参数 isTest 错误。</td><td>请检查公共请求参数 isTest 是否正确。</td></tr>\n    <tr><td>30005</td><td>无效的 AppId。</td><td>请检查 AppId 是否正确。</td></tr>\n    <tr><td>30009</td><td>无效的 StreamId，流名不规范。</td><td>请检查 StreamId 是否符合流名编码规范。</td></tr>\n    <tr><td>30010</td><td>无效的调度动作。</td><td>请检查 Type 是否正确。</td></tr>\n    <tr><td>30011</td><td>无效的客户端 IP 地址。</td><td>请检查 ClientIP 是否正确。</td></tr>\n  </tbody>\n</table>\n","example":0}}></SchemaItem><SchemaItem collapsible={false} name={"Message"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"操作结果描述","example":"ok"}}></SchemaItem><SchemaItem collapsible={false} name={"RequestId"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"请求 ID","example":"5094436160208407316"}}></SchemaItem><SchemaItem collapsible={false} name={"Data"} required={false} schemaName={"object"} qualifierMessage={undefined} schema={{"type":"object","description":"RTMP 推流或拉流节点。\n\n> **说明**\n>\n> 获取此节点后，请在 2 小时内发起推流或拉流，否则可能导致节点被占用或下线。因此，建议每次进行 RTMP 推拉流时，都调用本接口获得最新的节点。\n","example":["rtmp://81.69.49.115:1935/1540531164/caodantest"]}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"Code\": 0,\n  \"Message\": \"ok\",\n  \"RequestId\": \"5094436160208407316\",\n  \"Data\": [\n    \"rtmp://81.69.49.115:1935/1540531164/caodantest\"\n  ]\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem></ApiTabs></div></div>
      