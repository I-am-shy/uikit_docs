---
id: rtpm-dispatch
title: "RTMPDispatchV2"
description: "调用本接口可以发起 RTMP 推拉流调度，支持 'pull' 和 'push' 两种调度模式。"
api: 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
info_path: core_products/real-time-voice-video/zh/server/api-reference/media-service/open-api-desc
---

<h1 className={"openapi__heading"}>RTMPDispatchV2</h1>

<MethodEndpoint method={"get"} path={"/"}></MethodEndpoint>


调用本接口可以发起 RTMP 推拉流调度，支持 "pull" 和 "push" 两种调度模式。

当您需要自行通过 RTMP 协议，从 ZEGO 音视频云进行直播流的推流或拉流时，可以通过本接口获取 RTMP 的推流或拉流节点。开发者在客户端传入流 ID（StreamId）、调度模式（Type）、客户端 IP（ClientIP）和序列号（Sequence）后，ZEGO 媒体服务器（RTC 服务）返回调度结果集，供客户推拉流。

例如，当通过 OBS 等第三方推流工具进行 RTMP 推流时，需要进行推流调度；当需要第三方播放器拉 RTMP 流进行播放时，需要进行拉流调度。

<Warning title="注意">
首次使用本接口，需要联系 ZEGO 技术支持进行配置。
</Warning>
<Note title="调用频率限制">同一个 AppID 下：40 次/秒</Note>
## 旧版接口使用说明

<Accordion title="使用 RTMPDispatch 访问 ZEGO 服务端" defaultOpen="false">
<Note title="说明">

**RTMPDispatchV2（推荐）** 和 **RTMPDispatch** 的区别是，访问 ZEGO 服务端时：

- 使用的是 `RTMPDispatchV2`，ZEGO 服务端返回的 Data 数据为 URL 形式。
- 使用的是 `RTMPDispatch`，ZEGO 服务端返回的 Data 数据为 IP Port 形式。

</Note>

请求地址：`https://rtc-api.zego.im/?Action=RTMPDispatch`

响应示例：

```json
{
    "Code":0,
    "Message":"ok",
    "RequestId":"5094436160208407316",
    "Data":[
        "81.69.49.115:1935"
    ]
}
```
</Accordion>
<br/>

<Note title="说明">
测试环境下（详见 IsTest 公共参数说明），流 ID 需要加上 "zegotest-AppId-" 前缀。例如，流 ID 为 "test"，在 AppId 为 "123456789" 的测试环境下，流 ID 应为 "zegotest-123456789-test"。
</Note>

## Request
<details style={{"marginBottom":"1rem"}} className={"openapi-markdown__details"} data-collapsed={false} open={true}><summary style={{}}><h3 className={"openapi-markdown__details-summary-header-params"}>Query Parameters</h3></summary><div><ul><ParamsItem className={"paramsItem"} param={{"name":"Action","in":"query","description":"> 接口原型参数\n>\n> https://rtc-api.zego.im?Action=RTMPDispatchV2\n","required":true,"schema":{"type":"string","enum":["RTMPDispatchV2"]},"style":"form","explode":true}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"AppId","in":"query","description":"💡公共参数。应用 Id，由 ZEGO 分配的用户唯一凭证。可从 <a target=\"_blank\" href=\"https://console.zego.im/\">ZEGO 控制台</a> 获取。","required":true,"schema":{"type":"integer","format":"uint32"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"SignatureNonce","in":"query","description":"💡公共参数。16 位 16 进制随机字符串（8 字节随机数的 hex 编码）。生成算法可参考 <a href=\"/real-time-video-server/api-reference/accessing-server-apis#signature-example\">签名示例</a>。","required":true,"schema":{"type":"string"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"Timestamp","in":"query","description":"💡公共参数。当前 Unix 时间戳，单位为秒。生成算法可参考 <a href=\"/real-time-video-server/api-reference/accessing-server-apis#signature-example\">签名示例</a>，最多允许 10 分钟的误差。","required":true,"schema":{"type":"integer","format":"int64"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"Signature","in":"query","description":"💡公共参数。签名，用于验证请求的合法性。请参考[签名机制](/real-time-video-server/api-reference/accessing-server-apis#signature-mechanism)生成。","required":true,"schema":{"type":"string"}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"SignatureVersion","in":"query","description":"💡公共参数。签名版本号。","required":true,"schema":{"type":"string","default":"2.0","enum":["2.0"]}}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"StreamId","in":"query","required":true,"schema":{"type":"string"},"description":"流 ID，长度不超过 256 的字符串。\n- 流 ID 由您自己定义。\n- 在推流时，需要在整个 AppID 内全局唯一，若出现在同一个 AppID 内，不同的用户各推了一条流且流名相同，将会导致后推流的用户推流失败。\n- 仅支持数字，英文字符 和 '-', '_'。\n"}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"Sequence","in":"query","required":true,"schema":{"type":"Int64"},"description":"请求序列号；仅用于请求对帐，推荐使用时间戳（毫秒级别）。"}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"Type","in":"query","required":true,"schema":{"type":"string"},"description":"调度模式：\n- pull：获取 RTMP 的拉流节点\n- push：获取 RTMP 的推流节点\n"}}></ParamsItem><ParamsItem className={"paramsItem"} param={{"name":"ClientIP","in":"query","required":false,"schema":{"type":"string"},"description":"非必选，如有，则传入客户端 IP 地址，例如：119.23.242.129。\n\n> **注意**\n>\n> 当前不支持 IPv6 格式的 IP 地址。\n"}}></ParamsItem></ul></div></details>
<div><div><ApiTabs label={undefined} id={undefined}><TabItem label={"200"} value={"200"}><div>成功</div><div><MimeTabs className={"openapi-tabs__mime"} schemaType={"response"}><TabItem label={"application/json"} value={"application/json"}><SchemaTabs className={"openapi-tabs__schema"}><TabItem label={"Schema"} value={"Schema"}><details style={{}} className={"openapi-markdown__details response"} data-collapsed={false} open={true}><summary style={{}} className={"openapi-markdown__details-summary-response"}><strong>Schema</strong></summary><ul className={"response-schema-first-body-node-container"}><SchemaItem collapsible={false} name={"Code"} required={false} schemaName={"number"} qualifierMessage={undefined} schema={{"type":"integer","format":"number","description":"返回码。\n以下仅列出了接口业务逻辑相关的部分返回码，完整返回码请参考 [全局返回码](/real-time-video-server/api-reference/return-codes)。\n<table>\n  <thead>\n    <tr><th>返回码</th><th>说明</th><th>处理建议</th></tr>\n  </thead>\n  <tbody>\n    <tr><td>1010、30002</td><td>接口调用频率过高。</td><td>请降低接口请求频率。</td></tr>\n    <tr><td>1001</td><td>调度失败。</td><td>请联系 ZEGO 技术支持处理。</td></tr>\n    <tr><td>1002</td><td>推流节点为空。</td><td>请联系 ZEGO 技术支持处理。</td></tr>\n    <tr><td>1003</td><td>拉流节点为空。</td><td>请联系 ZEGO 技术支持处理。</td></tr>\n    <tr><td>1005</td><td>App 不在线。</td><td>请联系 ZEGO 技术支持处理。</td></tr>\n    <tr><td>1006</td><td>无效参数。</td><td>请联系 ZEGO 技术支持处理。</td></tr>\n    <tr><td>30003</td><td>内部错误。</td><td>请联系 ZEGO 技术支持处理。</td></tr>\n    <tr><td>30004</td><td>参数 isTest 错误。</td><td>请检查公共请求参数 isTest 是否正确。</td></tr>\n    <tr><td>30005</td><td>无效的 AppId。</td><td>请检查 AppId 是否正确。</td></tr>\n    <tr><td>30009</td><td>无效的 StreamId，流名不规范。</td><td>请检查 StreamId 是否符合流名编码规范。</td></tr>\n    <tr><td>30010</td><td>无效的调度动作。</td><td>请检查 Type 是否正确。</td></tr>\n    <tr><td>30011</td><td>无效的客户端 IP 地址。</td><td>请检查 ClientIP 是否正确。</td></tr>\n  </tbody>\n</table>\n","example":0}}></SchemaItem><SchemaItem collapsible={false} name={"Message"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"操作结果描述","example":"ok"}}></SchemaItem><SchemaItem collapsible={false} name={"RequestId"} required={false} schemaName={"string"} qualifierMessage={undefined} schema={{"type":"string","description":"请求 ID","example":"5094436160208407316"}}></SchemaItem><SchemaItem collapsible={false} name={"Data"} required={false} schemaName={"object"} qualifierMessage={undefined} schema={{"type":"object","description":"RTMP 推流或拉流节点。\n\n> **说明**\n>\n> 获取此节点后，请在 2 小时内发起推流或拉流，否则可能导致节点被占用或下线。因此，建议每次进行 RTMP 推拉流时，都调用本接口获得最新的节点。\n","example":["rtmp://81.69.49.115:1935/1540531164/caodantest"]}}></SchemaItem></ul></details></TabItem><TabItem label={"Example (from schema)"} value={"Example (from schema)"}><ResponseSamples responseExample={"{\n  \"Code\": 0,\n  \"Message\": \"ok\",\n  \"RequestId\": \"5094436160208407316\",\n  \"Data\": [\n    \"rtmp://81.69.49.115:1935/1540531164/caodantest\"\n  ]\n}"} language={"json"}></ResponseSamples></TabItem></SchemaTabs></TabItem></MimeTabs></div></TabItem></ApiTabs></div></div>
      