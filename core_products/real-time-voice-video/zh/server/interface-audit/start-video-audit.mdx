@@@ServerAPIWarning@@@

# 开始视频流审核

- - -

## 1 描述

视频流审核是 ZEGO 实时音视频产品的互动扩展服务。开发者通过视频流审核接口，可以调用实时视频审核对视频中的音频和画面进行审核，包括音频的语义和特征（音调、音色、声纹、旋律等）识别，视频画面中的文字语义和内容的识别。ZEGO 会通过 [视频流审核回调\|_blank](!Callback/Video_audit_callback) 或配置的自定义回调地址，把识别结果发送给开发者，开始视频流审核功能与 [结束视频流审核\|_blank](!Interface_audit/End_video_audit) 请结合使用。

@@@server_shumei_shenhe@@@


## 2 接口原型

- 请求方法：POST
  <div class="mk-hint">

  使用 POST 请求方法传递参数时：
  - Body 中的参数直接传 JsonObject 格式即可，无需序列化为 String 格式。
  - Headers 中，设置 “Content-type” 为 “application/json”。
  </div>


- 请求地址：https://rtc-api.zego.im/?Action=StartCensorVideoV2
- 传输协议：HTTPS
- 调用频率限制（同一个 AppID 下所有房间）：100 次/秒



## 3 请求参数

@@@Request_Params_Des@@@

<table class="collapsible-table" >
  <colgroup>
    <col width="20%">
    <col width="15%">
    <col width="15%">
    <col width="50%">
  </colgroup>
<tbody><tr data-row-level="1">
<th>参数</th>
<th>类型</th>
<th>是否必选</th>
<th>描述</th>
</tr>
<tr data-row-level="2">
<td>RoomId</td>
<td>String</td>
<td>是</td>
<td>需要进行音频审核的房间 ID。<br>
默认会将该房间内的所有流送审，如果房间内有流不需要送审（比如受信任的用户所推的流），请在调用客户端 SDK `startPublishingStream` 推流时，将 `ZegoPulisherConfig.streamCensorshipFlag` 设置为不允许送审。</td>
</tr>
<tr data-row-level="3">
<td>EventId</td>
<td>String</td>
<td>是</td>
<td>场景标识。<br>通过该参数标识音频流对应的场景。审核策略可以根据场景进行调整，从而实现不同的场景审核尺度的控制。<br>
<ul><li>直播：live_streaming。</li>li>1v1：private_chat。</li></ul>
如果以上可选值不能完全满足您的使用诉求，请联系 ZEGO 技术支持。</td>
</tr>
<tr data-row-level="4">
<td>Language</td>
<td>String</td>
<td>否</td>
<td>语言类型，对音频和截帧识别的语种类型。
- zh：中文（默认值）
- en：英文
- ar：阿拉伯语</td>
</tr>
<tr data-row-level="5" data-row-child="true">
<td>AudioParam</td>
<td>Object</td>
<td>否</td>
<td>音频的参数，不传则不审核音频流。</td>
</tr>
<tr data-row-level="5-1">
<td>RiskTypeList</td>
<td>Array of String</td>
<td>否</td>
<td>风险审核类别。<br>RiskTypeList 与 BusinessTypeList 至少一个不为空，如果二者同时为空，则不审核音频，仅审核视频。数组中可添加的值如下：<br>
音频语义：
- EROTIC：色情
- DIRTY：辱骂
- POLITY：涉政
- BAN：违禁
- VIOLENT：暴恐
- ADVERT：广告

音频特征：
- MOAN：娇喘
- ANTHEN：国歌识别
- BANEDAUDIO：违禁歌曲
- 如需其他特征，请联系 ZEGO 技术支持。
</td>
</tr>
<tr data-row-level="5-2">
<td>BusinessTypeList</td>
<td>Array of String</td>
<td>否</td>
<td>业务识别类别。<br>RiskTypeList 与 BusinessTypeList 至少一个不为空，如果二者同时为空，则不审核音频，仅审核视频。数组中可添加的值如下：<br>
音频语义:
- MOINIR：未成年人


音频特征：
- SING：唱歌
- LANGUAGE：语种识别
- VOICE：人声属性识别


音频流的识别并不仅限于违规内容，也可以辅助开发者进行业务运营。
如果以上可选值无法满足您的业务诉求，请联系 ZEGO 技术支持。</td>
</tr>
<tr data-row-level="5-3">
<td>AudioLanguage</td>
<td>Array of String</td>
<td>否</td>
<td>视频流中的音频语种。<br>
在需要识别音频的语义时，请准确传入该值。可选值：<br>
- zh：中文、ja：日语、ko：韩语、th：泰语
- vi：越南语、ms：马来语、tl：菲律宾语、id：印尼语
- hi：印地语中、ar：阿拉伯语、tr：土耳其语、en：英文
- es：西班牙语、pt：葡萄牙语、it：意大利语、fr：法语
- de：德语、ru：俄语</td>
</tr>
<tr data-row-level="5-4">
<td>ReturnAllText</td>
<td>Int32</td>
<td>否</td>
<td>是否返回当前 10s 片段的所有文本。
- 0：（默认值）返回风险等级为非 PASS 的音频片段文本。
- 1：返回所有风险等级的音频文本片段。
<br>审核结果的风险等级将分为以下三类：<br>
PASS：正常内容，建议直接放行。<br>REVIEW：可疑内容，建议人工审核。<br>REJECT：违规内容，建议直接拦截。<br></td>
</tr>
<tr data-row-level="5-5">
<td>ReturnPreText</td>
<td>Int32</td>
<td>否</td>
<td>是否返回违规片段的前一个片段文本。
- 0：（默认值）不返回违规片段前一个 10s 片段文字。
- 1：返回违规片段前一个 10s 片段文字。</td>
</tr>
<tr data-row-level="5-6">
<td>ReturnPreAudio</td>
<td>Int32</td>
<td>否</td>
<td>是否返回违规片段的前一个音频片段链接。
- 0：（默认值）不返回违规片段前一个 10s 片段音频，只返回违规片段音频链接。
- 1：返回违规片段前一个 10s 片段音频链接。</td>
</tr>
<tr data-row-level="5-7">
<td>ResultCallbackUrl</td>
<td>String</td>
<td>否</td>
<td>自定义审核结果的回调地址。<br>
如果您需要将此次审核任务的审核结果，通过其他的回调地址抛出，可以通过本参数实现。如果不需要，可以在 ZEGO 控制台配置统一的回调地址，详情请参考 [控制台 - 云市场 - 数美内容审核|_blank](18891#3)。</td>
</tr>
<tr data-row-level="5-8">
<td>StatusCallbackUrl</td>
<td>String</td>
<td>否</td>
<td>自定义审核状态回调地址。<br>
如果您需要将此次审核任务的审核状态，通过其他的回调地址抛出，可以通过本参数实现。如果不需要，可以在 ZEGO 后台配置统一的回调地址，详情请参考 [控制台 - 云市场 - 数美内容审核|_blank](18891#3)。</td>
</tr>
<tr data-row-level="6" data-row-child="true">
<td>VideoParam</td>
<td>Object</td>
<td>是</td>
<td>视频审核相关参数。</td>
</tr>
<tr data-row-level="6-1">
<td>RiskTypeList</td>
<td>Array of String</td>
<td>否</td>
<td>风险审核类别。<br> RiskTypeList 与 BusinessTypeList 至少一个不为空。数组中可添加的值如下：<br>

画面文字语义：
- IMGTEXTRISK：基础违规识别，包含多个常见标签（涉政、暴恐、违禁、色情、辱骂、广告、灌水隐私、广告法）

画面内容：
- POLITY：涉政
- EROTIC：色情、性感
- VIOLENT：暴恐、违禁
- QRCODE：二维码
- ADVERT：广告
如果以上可选值无法满足您的业务诉求，请联系 ZEGO 技术支持。</td>
</tr>
<tr data-row-level="6-2">
<td>BusinessTypeList</td>
<td>Array of String</td>
<td>否</td>
<td>业务识别类别。<br> RiskTypeList 与 BusinessTypeList 至少一个不为空。数组中可添加的值：<br>

画面内容:
- AGE：未成年人
- PHOTOMATERIALLOGO：CFP 等版权 LOGO，还支持其他十余种 LOGO，详情请联系技术支持了解。

画面内容扩展：
- FACEDETECTION：人脸检测
- BEAUTY：颜值打分

视频流的识别并不仅限于违规内容，也可以辅助开发者进行业务运营。
如果以上可选值无法满足您的业务诉求，请联系 ZEGO 技术支持。</td>
</tr>
<tr data-row-level="6-3">
<td>ReturnAllImg</td>
<td>Int32</td>
<td>否</td>
<td>视频流截帧的风险等级，建议传入 1。<br>
- 0：（默认值）返回风险等级为非 PASS 的截帧审核信息。
- 1：返回所有风险等级的截帧审核信息。

审核结果的风险等级将分为以下三类：<br>PASS：正常内容，建议直接放行。<br>REVIEW：可疑内容，建议人工审核。<br>REJECT：违规内容，建议直接拦截。<br></td>
</tr>
<tr data-row-level="6-4">
<td>DetectFrequency</td>
<td>Int32</td>
<td>否</td>
<td>截帧频率。<br>单位：秒。默认为 3s 截帧一次进行审核。</td>
</tr>
<tr data-row-level="6-5">
<td>ResultCallbackUrl</td>
<td>String</td>
<td>否</td>
<td>自定义审核结果的回调地址。<br>
如果您需要将此次审核任务的审核结果，通过其他的回调地址抛出，可以通过本参数实现。如果不需要，可以在 ZEGO 控制台配置统一的回调地址，详情请参考 [控制台 - 云市场 - 数美内容审核|_blank](18891#3)。</td>
</tr>
<tr data-row-level="6-6">
<td>StatusCallbackUrl</td>
<td>String</td>
<td>否</td>
<td>自定义审核状态回调地址。<br>
如果您需要将此次审核任务的审核状态，通过其他的回调地址抛出，可以通过本参数实现。如果不需要，可以在 ZEGO 后台配置统一的回调地址，详情请参考 [控制台 - 云市场 - 数美内容审核|_blank](18891#3)。</td>
</tr>
<tr data-row-level="7">
<td>ReturnFinishInfo</td>
<td>Int32</td>
<td>否</td>
<td>审核任务结束时，是否进行“审核任务状态”回调。
- 0：审核结束时不发送结束通知。
- 1：审核结束时发起结束通知。</td>
</tr>
</tbody></table>



## 4 请求示例
- 请求 URL  
    ```
    https://rtc-api.zego.im/?Action=StartCensorVideoV2
    &<公共请求参数>
    ```
- 请求消息体 
    ```
    {
        "RoomId": "room_1",
        "EventId": "live_streaming",
        "Language": "zh",
        "AudioParam": {
            "RiskTypeList": [
                "ADLAW",
                "ADVERT",
                "AUDIOPOLITICAL",
                "DIRTY",
                "EROTIC",
                "MOAN",
                "POLITY"
            ],
            "ReturnAllText": 1,
            "ReturnPreAudio": 1,
            "ReturnPreText": 1,
            "ResultCallbackUrl": "",
            "StatusCallbackUrl": ""
        },
        "VideoParam": {
            "RiskTypeList": [
                "ADVERT",
                "EROTIC",
                "IMGTEXTRISK",
                "POLITY",
                "QRCODE",
                "VIOLENT"
            ],
            "ReturnAllImg": 1,
            "DetectFrequency": 5,
            "ResultCallbackUrl": "",
            "StatusCallbackUrl": ""
        },
        "ReturnFinishInfo": 1
    }
    ```

## 5 响应参数

<table class="collapsible-table" >
  <colgroup>
    <col width="20%">
    <col width="20%">
    <col width="60%">
  </colgroup>
<tbody><tr data-row-level="1">
<th>参数</th>
<th>类型</th>
<th>描述</th>
</tr>
<tr data-row-level="2">
<td>Code</td>
<td>Int32</td>
<td>返回码。
- 50006、50007：HTTP 请求失败，请稍后重试（建议 300s）。若仍然失败，可联系 ZEGO 技术支持处理。
- 50009：审核失败，请稍后重试（建议 300s），或联系 ZEGO 技术支持处理。
- 50117：配置错误，未开通数美音视频流审核权限。请参考 [控制台 - 云市场 - 数美内容审核\|_blank](#18891)，按照页面指引，自助开通 `数美内容审核` 相关权限。</td>
</tr>
<tr data-row-level="3">
<td>Message</td>
<td>String</td>
<td>操作结果描述。</td>
</tr>
<tr data-row-level="4">
<td>RequestId</td>
<td>String</td>
<td>请求 ID。</td>
</tr>
<tr data-row-level="5" data-row-child="true">
<td>Data</td>
<td>Object</td>
<td>响应数据。</td>
</tr>
<tr data-row-level="5-1">
<td>TaskId</td>
<td>String</td>
<td>审核任务 ID，用于结束审核任务。</td>
</tr>
</tbody></table>



## 6 响应示例

```
{
    "Code": 0,
    "Data": {
        "TaskId": "05e7a786a5191e8f5eb8e5851b01afcd"
    },
    "Message": "success",
    "RequestId": "TestRequestId1722597387688544000"
}
```

## 7 返回码

@@@Return_Params_Des@@@

|返回码|说明| 处理建议 |
|-----|----|----|
| 50006、50007 |  HTTP 请求失败。 | 请稍后重试（建议 300s），或联系 ZEGO 技术支持。|
| 50009 | 审核失败。 | 请稍后重试（建议 300s），或联系 ZEGO 技术支持。|
| 50117 | 配置错误，未开通数美权限。 | 请参考 [控制台 - 云市场 - 数美内容审核\|_blank](#18891)，按照页面指引，自助开通 `数美内容审核` 相关权限。|
