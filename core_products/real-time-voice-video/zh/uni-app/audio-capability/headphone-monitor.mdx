# 耳返与声道设置

- - -

## 1 功能简介

@@@Ear-back_and_Channel_Settings_Function_Introduction@@@

## 2 示例源码下载

请参考 [下载示例源码\|_blank](!DownloadDemo/DownloadDemo) 获取源码。

相关源码请查看 “/ZegoExpressExample/AdvancedAudioProcessing/src/main/java/im/zego/advancedaudioprocessing/voicechange” 目录下的文件。

## 3 前提条件

在进行耳返与声道设置之前，请确保：

@@@Express-Video_Prerequisites@@@


## 4 使用步骤

### 4.1 设置耳返

#### 4.1.1 开启耳返

开启预览后或者开始推流后调用 [enableHeadphoneMonitor\|_blank](@enableHeadphoneMonitor) 开启采集监听即耳返，主播方讲话后，会听到自己的声音。

<div class = 'mk-hint'>

开启耳返后，在连接上耳麦时耳返功能才实际生效。
</div>


```java
engine.enableHeadphoneMonitor(true);
```

#### 4.1.2 设置耳返音量

开启预览后或者开始推流后可调用 [setHeadphoneMonitorVolume\|_blank](@setHeadphoneMonitorVolume) 调整耳返的音量。

其中参数 “volume” 为采集耳返音量大小，取值范围为 0 ～ 200，默认 “100”。

```java
engine.setHeadphoneMonitorVolume(100);
```

### 4.2 设置声道

<div class="mk-warning">

[setAudioConfig\|_blank](@setAudioConfig) 和 [setAudioCaptureStereoMode\|_blank](@setAudioCaptureStereoMode) 都需要在 [startPublishingStream\|_blank](@startPublishingStream)、[startPlayingStream\|_blank](@startPlayingStream)、[startPreview\|_blank](@startPreview)、[createMediaPlayer\|_blank](@createMediaPlayer) 和 [createAudioEffectPlayer\|_blank](@createAudioEffectPlayer) 之前调用才有效。 
</div>

#### 4.2.1 设置音频双声道编码

在推流前调用 [setAudioConfig\|_blank](@setAudioConfig) 方法设置音频质量相关配置，其中音频编码声道参数 “channel” 需要设置为双声道编码（默认值为单声道编码），其他参数取默认值即可。

```java
ZegoAudioConfig audioConfig = new ZegoAudioConfig(ZegoAudioConfigPreset.HIGH_QUALITY_STEREO));
ZegoExpressEngine.getEngine().setAudioConfig(audioConfig);
```

#### 4.2.2 设置音频采集双声道模式

调用 [setAudioCaptureStereoMode\|_blank](@setAudioCaptureStereoMode) 方法开启音频双声道采集，并根据实际场景设置 “Mode” 参数（默认值为始终不开启双声道），用于实现始终开启双声道采集或仅在推流时开启双声道。

```java
ZegoExpressEngine.getEngine().setAudioCaptureStereoMode(ZegoAudioCaptureStereoMode.ALWAYS);
```

#### 4.2.3 推流

请参考 [快速开始 - 实现流程\|_blank](!Integration/Solution_Implementation#3_3) 的 “3.3 推流”，此时所推流的音频是双声道，拉流端无需做额外的配置，直接拉流即可播放双声道音频。

<div class="mk-hint">

双声道采集需要推流端使用支持双声道采集的设备作为音频输入源，一般手机的麦克风不支持采集双声道。
</div>
 

## 5 API 参考列表

| 方法 | 描述 |
|-------|--------|
| [enableHeadphoneMonitor \|_blank](@enableHeadphoneMonitor) | 开启/关闭耳返 |
| [setHeadphoneMonitorVolume \|_blank](@setHeadphoneMonitorVolume) | 设置耳返音量 |
| [setAudioConfig\|_blank](@setAudioConfig) | 设置音频质量配置 |
| [setAudioCaptureStereoMode\|_blank](@setAudioCaptureStereoMode) | 设置音频采集双声道模式 |
| [startPublishingStream \|_blank](@startPublishingStream) | 开始推流 |
