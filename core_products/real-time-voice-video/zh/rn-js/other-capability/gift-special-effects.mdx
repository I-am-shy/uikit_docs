---
articleID: 18931
---
# 播放透明礼物特效

- - -

## 功能简介

@@@gift_special_effects_info@@@

## 前提条件

在使用媒体播放器播放 MP4 动态效果，即实现播放透明礼物特效之前，请确保：

@@@Express-Video_Prerequisites@@@



## 实现流程

### 1 输出素材

@@@Express_gift_special_effects_step1@@@


### 2 创建媒体播放器

调用 [createMediaPlayer\|_blank](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressengine_.zegoexpressengine.html#createmediaplayer) 创建媒体播放器。

```javascript
ZegoExpressEngine.instance().createMediaPlayer().then((player) => {
  this.mediaPlayer = player;
});
```

### 3 加载素材

调用 [createMediaPlayer\|_blank](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressengine_.zegoexpressengine.html#createmediaplayer) 创建媒体播放器后，通过 [loadResourceWithConfig\|_blank](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressdefines_.zegomediaplayer.html#loadresourcewithconfig) 接口，通过**文件路径**，播放拼接后的特效素材。

<div class="mk-warning">

虽然 [loadResourceWithConfig\|_blank](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressdefines_.zegomediaplayer.html#loadresourcewithconfig) 接口支持通过版权音乐资源 ID 加载多媒体资源，但是版权音乐目前不支持视频，因此无法通过版权音乐资源 ID 加载方式来加载礼物特效。
</div>

```javascript
var RNFS = require('react-native-fs');

let resource = new ZegoMediaPlayerResource()
let path = "/static/source1_complex_rl.mp4"
resource.loadType = ZegoMultimediaLoadType.FilePath //加载方式选择文件路径加载
resource.filePath = RNFS.MainBundlePath + path //文件路径
resource.alphaLayout = ZegoAlphaLayoutType.Left //根据实际资源选择 Alpha 通道布局
this.mediaPlayer.loadResourceWithConfig(resource).then((ret) => {
    console.log("load resource error: " + ret.errorCode)
});
```

### 4 播放素材

在调用 [loadResourceWithConfig\|_blank](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressdefines_.zegomediaplayer.html#loadresourcewithconfig) 加载文件成功后，可调用 [start\|_blank](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressdefines_.zegomediaplayer.html#start)、[pause\|_blank](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressdefines_.zegomediaplayer.html#pause)、[resume\|_blank](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressdefines_.zegomediaplayer.html#resume)、[stop\|_blank](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressdefines_.zegomediaplayer.html#stop) 来启停播放。一旦播放器的内部状态改变，[ZegoMediaPlayer\|_blank](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressdefines_.zegomediaplayer.html) 的 [mediaPlayerStateUpdate\|_blank](/unique-api/express-video-sdk/zh/javascript_react-native/interfaces/_zegoexpresseventhandler_.zegomediaplayerlistener.html#mediaplayerstateupdate) 回调将会被触发。

用户也可通过调用 [getCurrentState\|_blank](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressdefines_.zegomediaplayer.html#getcurrentstate) 随时获取播放器的当前状态。

如果 [enableRepeat\|_blank](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressdefines_.zegomediaplayer.html#enablerepeat) 设置为 `YES`，则播放器会在播放完文件后自动重播。

```javascript
// 开始播放，播放之前需要先调用接口加载媒体文件
this.mediaPlayer.start();
// 暂停
this.mediaPlayer.pause();
// 恢复
this.mediaPlayer.resume();
// 停止
this.mediaPlayer.stop();
```

### 5 播放器透明视图控制

当播放视频资源时，设置 [ZegoView\|_blank](/unique-api/express-video-sdk/zh/javascript_react-native/modules/_index_.html#zegoview) 里的 `alphaBlend` 参数为 `true`，开启播放器透明效果，然后调用 [setPlayerView\|_blank](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressdefines_.zegomediaplayer.html#setplayerview) 接口设置视频的显示视图。

<div class="mk-warning">

初次创建生效后，不可实时更改。如需更改，需要重新创建或刷新视图标签。
</div>

```javascript
let mediaPlayer = await ZegoExpressEngine.instance().createMediaPlayer();
mediaPlayer.setPlayerView({"reactTag": findNodeHandle(this.refs.zego_media_view), "viewMode": 0, "backgroundColor": 0, alphaBlend: true});
```

### 6 销毁媒体播放器

媒体播放器使用完毕后，需要及时调用 [destroyMediaPlayer\|_blank](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressengine_.zegoexpressengine.html#destroymediaplayer) 接口销毁播放器实例变量，释放占用的资源。

```javascript
// 销毁媒体播放器 
ZegoExpressEngine.instance().destroyMediaPlayer(this.mediaPlayer)
```
