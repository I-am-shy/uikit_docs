---
articleID: 8848
---
# 实时消息与信令


- - -

## 功能简介

@@@message_intro@@@


## 前提条件

在发送实时消息前，请确保：

@@@Express-Video_Prerequisites@@@

## 使用步骤

### 收发广播消息

1. **发送广播消息**

   调用 [sendBroadcastMessage ](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressengine_.zegoexpressengine.html#sendbroadcastmessage) 接口向同一房间内的其他用户发送广播消息，长度不能超过 1024 字节。

   通过 [ZegoIMSendBroadcastMessageResult ](/unique-api/express-video-sdk/zh/javascript_react-native/interfaces/_zegoexpressdefines_.zegoimsendbroadcastmessageresult.html) 异步结果的返回获取消息发送结果。

   ```javascript
   // 发送广播消息
   ZegoExpressEngine.instance().sendBroadcastMessage("ChatRoom-1", "This is a broadcast message").then((result) => {
       // 获取消息发送结果
   })
   ```

2. **接收广播消息**

   通过调用 ZegoExpressEngine 的 [on ](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressengine_.zegoexpressengine.html#on) 方法，设置监听 [IMRecvBroadcastMessage ](/unique-api/express-video-sdk/zh/javascript_react-native/interfaces/_zegoexpresseventhandler_.zegoeventlistener.html#imrecvbroadcastmessage) 的事件回调，当发送方成功发送广播消息后，同一房间内的其他用户通过此回调接收相关信息，包括消息内容、消息 ID、发送时间及发送方信息。

   ```javascript
   // 收到其他用户发送消息
   ZegoExpressEngine.instance().on('IMRecvBroadcastMessage', (roomID, messageList) => {
        console.log("received broadcast message") 
       })
   ```

### 收发弹幕消息

1. **发送弹幕消息**

   调用 [sendBarrageMessage ](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressengine_.zegoexpressengine.html#sendbarragemessage) 接口向同一房间内的其他用户发送弹幕消息，长度不能超过 1024 字节。

   通过 [ZegoIMSendBarrageMessageResult ](/unique-api/express-video-sdk/zh/javascript_react-native/interfaces/_zegoexpressdefines_.zegoimsendbarragemessageresult.html) 异步结果的返回获取消息发送结果。

   ```javascript
   // 发送房间弹幕消息
   ZegoExpressEngine.instance(). sendBarrageMessage("ChatRoom-1", "This is a barrage message").then((result) => {
       // 获取消息发送结果
   })
   ```

2. **接收弹幕消息**

   通过调用 ZegoExpressEngine 的 [on ](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressengine_.zegoexpressengine.html#on) 方法，设置监听 [IMRecvBarrageMessage ](/unique-api/express-video-sdk/zh/javascript_react-native/interfaces/_zegoexpresseventhandler_.zegoeventlistener.html#imrecvbarragemessage) 的事件回调，当发送方成功发送弹幕消息后，同一房间内的其他用户通过此回调接收相关信息，包括消息内容、消息 ID、发送时间及发送方信息。

   ```javascript
   // 收到其他用户发送消息
   ZegoExpressEngine.instance().on('IMRecvBarrageMessage', (roomID, messageList) => {
        console.log("received barrage message") 
       })
   ```

### 收发自定义信令

1. **发送自定义信令**

   调用 [sendCustomCommand ](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressengine_.zegoexpressengine.html#sendcustomcommand) 接口向同一房间内通过 “toUserList” 指定的用户发送自定义信令，长度不能超过 1024 字节。

   通过 [ZegoIMSendCustomCommandResult ](/unique-api/express-video-sdk/zh/javascript_react-native/interfaces/_zegoexpressdefines_.zegoimsendcustomcommandresult.html) 异步结果的返回获取消息发送结果。

   ```javascript
   // 发送自定义信令，`toUserList` 中指定的用户才可以通过 IMRecvCustomCommand 事件收到此信令
   // 若 `toUserList` 参数传空数组， 则 SDK 将发送该信令给房间内所有用户
   ZegoExpressEngine.instance().sendCustomCommand("ChatRoom-1", "This is a custom command", toUserList)
   ```

2. **接收自定义信令**

    通过调用 ZegoExpressEngine 的 [on ](/unique-api/express-video-sdk/zh/javascript_react-native/classes/_zegoexpressengine_.zegoexpressengine.html#on) 方法，设置监听 [IMRecvCustomCommand ](/unique-api/express-video-sdk/zh/javascript_react-native/interfaces/_zegoexpresseventhandler_.zegoeventlistener.html#imrecvcustomcommand) 的事件回调，当发送方成功发送自定义信令后，同一房间内的指定用户通过此回调接收相关信息，包括消息内容和消息发送方信息。

   ```javascript
   // 收到其他用户发送消息
   ZegoExpressEngine.instance().on('IMRecvCustomCommand', (roomID, fromUser, command) => {
        console.log("received custom command") 
       })
   ```
