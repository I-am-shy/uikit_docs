<div class="download-area">
    <div class="sdk-download-item-wrapper">
        <div class="download-title">示例源码</div>
        <div class="download-selector">
            <div class="download-select-wrapper" style="padding-right: 0;">
            <a class="download-target-btn" href="javascript:void(0);">本地下载</a>
                <ul class="download-dropdown-list">
                    <li data-href="https://storage.zego.im/express/example/video/linux_cli_java/ZegoExpressDemo_linux_cli_java.zip"
                        class="dropdown-option">
                    本地下载
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

## 示例源码运行指引



本文介绍如何快速跑通示例源码，体验基础的音视频通话服务。

### 准备环境

在开始集成 ZEGO Express SDK 前，请确保开发环境满足以下要求：

- 任意具有 GLIBC 2.16 或以上版本的 Linux 发行版系统，支持 x86_64、aarch64、armhf、armel 架构。
- JDK 1.7 或以上版本。
- Apache Maven 3.6 或以上版本。
- libasound（ALSA）。
- libv4l2（v4l utils）。

<div class="mk-hint">

- SDK 依赖 libasound (ALSA) 和 libv4l2 (v4l utils)。
- CentOS (RHEL/Fedora) 可以通过执行 `yum install alsa-lib-devel libv4l-devel` 命令安装。
- Ubuntu (Debian/Deepin) 可以通过执行 `apt install libasound2-dev libv4l-dev` 命令安装。
- 其他平台和系统请自行安装。
- 若需要交叉编译，请参考 [如何交叉编译 Linux alsa-lib 依赖库？](http://doc-zh.zego.im/faq/alsa_lib_cross_compile?product=ExpressAudio&platform=linux) 和 [如何交叉编译 Linux v4l-utils 依赖库？](http://doc-zh.zego.im/faq/v4l_utils_cross_compile?product=ExpressVideo&platform=linux) 两篇文档，同时目标机器需安装好 libasound 和 libv4l2 依赖库。

</div>

### 前提条件

@@@Demo_Prerequisites@@@

### 构建示例源码工程

#### 示例源码目录结构

下列结构为工程目录的文件结构，下文所涉及的文件路径均为相对于此目录的路径。

```
.
├─ README.md
├─ README_zh.md
└─ ZegoExpressExample
   ├─ libs # Zego Express Linux SDK 存放目录
   ├─ pom.xml
   ├─ src # 示例源码
```

1. 打开终端，执行 `cd`，进入项目的根目录（即 “pom.xml” 文件所在的目录）。

2. 在 [下载](#5569) 页面获取 SDK 包，解压后，将 “ZegoExpressEngine.jar” 文件安装到本地 maven。

    ```sh
    $ mvn install:install-file -Dfile=libs/ZegoExpressEngine.jar -DgroupId=im.zego.express -DartifactId=ZegoExpressEngine -Dversion=1 -Dpackaging=jar
    ```

#### 编译并打包示例源码。

```sh
$ mvn compile assembly:single
```

<div class="mk-hint">

您也可以使用 “IntelliJ IDEA”，即使用 IDE 打开工程来调试编译代码。

</div>

### 运行示例源码

#### 运行示例源码前，检查依赖是否满足

找到机器对应架构的 SDK Native 动态库的目录 (即存放 `libZegoExpressEngine.so` 的目录)，打开终端执行以下命令查看输出，如果有 `not found` 等信息，说明依赖未满足，请检查并安装缺失的依赖。

```sh
$ ldd libZegoExpressEngine.so
```

示例源码包含三个示例，开发者请根据需要，分别运行对应的示例。

#### 运行媒体播放器示例

开发者需要使用 `-Dsun.boot.library.path=/path/to/the/native/folder` 参数，来运行 “ZegoExpressExample.jar”，否则 SDK 的 Java 代码无法加载 Native 库。

```sh
$ java -Dsun.boot.library.path=libs/x86_64 -jar target/ZegoExpressExample.jar -example media_player -app_id 123456789 -user_id your_user_id -app_sign xxxxxxxx -media_path <path/to/the/media.mp4> -room_id your_room_id -stream_id your_stream_id
```

或者，可以使用 `-native_path <path/to/libZegoExpressEngine.so>` 参数，来运行 “ZegoExpressExample.jar”。

```sh
$ java -jar target/ZegoExpressExample.jar -example media_player -app_id 123456789 -user_id your_user_id -app_sign xxxxxxxx -media_path <path/to/the/media.mp4> -room_id your_room_id -stream_id your_stream_id -native-path <path/to/libZegoExpressEngine.so>
```

#### 运行媒体推流器示例

开发者需要使用如下参数，运行媒体推流器示例。

```sh
$ java -Dsun.boot.library.path=libs/ -jar target/ZegoExpressExample.jar -example media_data_publisher -app_id 123456789 -user_id your_user_id -app_sign xxxxxxxx -media_path <path/to/the/media.mp4> -room_id your_room_id -stream_id your_stream_id
```

#### 运行拉流示例

开发者需要使用如下参数，运行拉流示例。

```sh
$ java -Dsun.boot.library.path=libs/ -jar target/ZegoExpressExample.jar -example playing -app_id 123456789 -user_id your_user_id -app_sign xxxxxxxx -room_id your_room_id -stream_id your_stream_id
```

#### 运行效果

<img src="/Pics/Linux/Express/run_express_java_se_cli_demo.png" width="80%">

### 体验实时音视频功能

@@@New_Experience_RTC_Functions@@@

## 常见问题

#### **运行示例 Demo 时，出现如下报错，该如何处理？**

`Exception in thread "main" java.lang.UnsatisfiedLinkError: 'java.lang.String im.zego.zegoexpress.internal.ZegoExpressEngineJniAPI.getVersionJni()'`

请检查 Native 动态库目录路径是否设置正确，指向的目录中需要包含与机器架构一致的 `libZegoExpressEngine.so`。

然后再通过 `$ ldd libZegoExpressEngine.so` 检查依赖是否满足 (确保所有依赖都能找到，即没有 `not found` 信息)。
