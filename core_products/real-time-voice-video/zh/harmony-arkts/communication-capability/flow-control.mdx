---
articleID: 19428
---
# 流量控制

---

## 功能简介

@@@Flow_Control_OverView@@@

## 示例源码下载

请参考 [跑通示例源码](!DownloadDemo/DownloadDemo) 获取源码。

相关源码请查看 “/page/Topics/FlowControl/” 目录下的文件 FlowControl.ets。


## 使用步骤

### 1 开启流量控制

推流前调用 [enableTrafficControl](/unique-api/express-video-sdk/zh/ets_ohos/classes/_zegoexpressengine_.zegoexpressengine.html#enabletrafficcontrol) 接口，通过 “enable” 参数开启流量控制，并通过 “property” 参数设置可调节的流量控制属性（码率、帧率、分辨率）。支持选择多项，默认值为 “AdaptiveFPS”，即动态调整帧率。当上行带宽不足时，SDK 会根据当前网络环境，根据设置的`property`参数减少最终推流的上行码率，以适应上行带宽。

<div class = 'mk-warning'>

- 当关闭流量控制开关后，已设置的流量控制属性 “property” 也将失效。
- 在不同场景下，流量控制的属性设置不同。例如秀场直播场景需要保证视频流畅性，推荐选择分辨率自适应；教育场景需要保证清晰度，推荐选择帧率自适应。
</div>

```ets
// 开启流量控制，且同时开启分辨率和帧率自适应
this.ZegoExpressInstance.enableTrafficControl(true, AdaptiveFPS | AdaptiveResolution);
```

### 3 设置流量控制视频码率最小值

@@@Frame_Difference_Description@@@

开启流量控制后，调用 [setMinVideoBitrateForTrafficControl](/unique-api/express-video-sdk/zh/ets_ohos/classes/_zegoexpressengine_.zegoexpressengine.html#setminvideobitratefortrafficcontrol) 方法设置视频码率最小值（默认值为 “0”）及视频发送模式，可以使 SDK 在网络未达到发送视频的最小码率时，采用该方法设置视频发送模式（不发送视频或以极低的帧率发送）。

<div class = 'mk-warning'>

可以在初始化 SDK 后的任意时间调用，但需要开启流量控制后该设置才生效。
</div>

```ets
// 开启流控后，当码率低于 200 kbps 时，以极低的帧率继续发送视频数据
this.ZegoExpressInstance.setMinVideoBitrateForTrafficControl(200, ZegoTrafficControlMinVideoBitrateMode.UltraLowFPS);
```
