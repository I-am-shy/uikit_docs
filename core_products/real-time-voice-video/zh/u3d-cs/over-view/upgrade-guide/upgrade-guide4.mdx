---
articleID: 16580
---
<style>
table th:nth-of-type(1) {min-width: 120px; width: 30%;}
table {width: 100%;}
</style>

# 3.0.0 及以上版本升级指南

---

@@@Express_Update_Note_300@@@


本文将介绍 Express SDK 版本升级至 3.0.0 及以上版本时的说明和注意事项。

## 废弃说明

1. 废弃 [ZegoScenario\|_blank](@-ZegoScenario) 场景枚举中的 `General`、`Communication`、`Live` 三种场景，请参考 [场景化音视频配置\|_blank](!video_proflie) 文档进行适配。

2. 从 3.0.0 版本开始，Express iOS SDK 不再支持 bitcode，详情请参考 [Xcode 14 Release Notes\|_blank](https://developer.apple.com/documentation/xcode-release-notes/xcode-14-release-notes#Deprecations) 中关于废弃 bitcode 的说明。

<div class="mk-hint">

适配方式：打开 Xcode 工程的配置页面，在 App Target 的 "Build Settings" 页面中找到 "Enable Bitcode" 选项，将其设置为 "No"。
</div>


    

## 删除说明

删除下列在先前版本已废弃的接口。

方法名 | 描述 |
--- | --- |
SetDebugVerbose | 设置调试详细信息开关以及语言。此函数在 2.3.0 版本废弃，请使用 [EnableDebugAssistant\|_blank](@EnableDebugAssistant) 来实现原来的功能。
LoginMultiRoom | 登录多房间。此方法在版本 2.9.0 以后已废弃，若需实现多房间功能，请先在引擎初始化之前调用 [SetRoomMode\|_blank](@SetRoomMode) 函数设置多房间模式，再使用 [LoginRoom\|_blank](@LoginRoom) 登录多房间，如果调用 [LoginRoom\|_blank](@LoginRoom) 函数登录多房间，请确保传入相同的用户信息。
SetPlayStreamVideoLayer | 设置选取拉流视频图层。此函数在 2.3.0 版本以后已废弃, 请使用 [SetPlayStreamVideoType\|_blank](@SetPlayStreamVideoType) 代替。
EnableAudioDataCallback | 开启额外接收音频数据的回调。此函数在 2.7.0 版本以后已废弃，请使用 [StartAudioDataObserver\|_blank](@StartAudioDataObserver) 和 [StopAudioDataObserver\|_blank](@StopAudioDataObserver) 代替。
SetBuiltInSpeakerOn | 是否使用内置扬声器播放声音。此函数在 2.3.0 版本以后已废弃，请使用 [SetAudioRouteToSpeaker\|_blank](@SetAudioRouteToSpeaker) 代替。
OnDeviceError | 设备异常通知。此函数在 2.15.0 版本及以上已废弃，请使用 [OnLocalDeviceExceptionOccurred\|_blank](@OnLocalDeviceExceptionOccurred) 代替。

## 变更示例代码

您可以参考以下示例代码进行接口变更。

### SetDebugVerbose

#### 3.0.0 版本前

```cs
ZegoExpressEngine.GetEngine().SetDebugVerbose(true, ZegoLanguage.English);
```

#### 3.0.0 版本及以上

```cs
// 注意，请勿在线上版本开启此功能！仅在开发阶段使用！
// Note, do not enable this feature in the online version! Use only during development phase!"
ZegoExpressEngine.GetEngine().EnableDebugAssistant(true);
```

### LoginMultiRoom

#### 3.0.0 版本前

```cs
ZegoExpressEngine.CreateEngine(profile, null);

ZegoUser user = new ZegoUser("user1");
ZegoExpressEngine.GetEngine().LoginRoom("first_room", user);
ZegoExpressEngine.GetEngine().LoginMultiRoom("second_room", null);
```

#### 3.0.0 版本及以上



```cs
// 必须在调用 [createEngine] 之前设置才生效，否则会失败。
// Must be set before calling [createEngine] to take effect, otherwise it will fail.
ZegoExpressEngine.SetRoomMode(ZegoRoomMode.MULTI_ROOM);

ZegoExpressEngine.CreateEngine(profile, null);

ZegoUser user = new ZegoUser("user1");
ZegoExpressEngine.GetEngine().LoginRoom("first_room", user);
ZegoExpressEngine.GetEngine().LoginRoom("second_room", user);
```

### SetPlayStreamVideoLayer

#### 3.0.0 版本前

```cs
ZegoExpressEngine.GetEngine().SetPlayStreamVideoLayer("stream1", ZegoPlayerVideoLayer.Auto);
```

#### 3.0.0 版本及以上



```cs
ZegoExpressEngine.GetEngine().SetPlayStreamVideoType("stream1", ZegoVideoStreamType.Default);
```

### EnableAudioDataCallback

#### 3.0.0 版本前

```cs
int bitmask = ZegoAudioDataCallbackBitMask.Captured | ZegoAudioDataCallbackBitMask.Player;
ZegoAudioFrameParam param = new ZegoAudioFrameParam();
param.sampleRate = ZegoAudioSampleRate.ZegoAudioSampleRate48K;
param.channel = ZegoAudioChannel.Mono;

// Start
ZegoExpressEngine.GetEngine().SetAudioDataHandler(handler);
ZegoExpressEngine.GetEngine().EnableAudioDataCallback(true, bitmask, param);

// Stop
ZegoExpressEngine.GetEngine().SetAudioDataHandler(null);
ZegoExpressEngine.GetEngine().EnableAudioDataCallback(false, bitmask, param);
```

#### 3.0.0 版本及以上

```cs
int bitmask = ZegoAudioDataCallbackBitMask.Captured | ZegoAudioDataCallbackBitMask.Player;
ZegoAudioFrameParam param = new ZegoAudioFrameParam();
param.sampleRate = ZegoAudioSampleRate.ZegoAudioSampleRate48K;
param.channel = ZegoAudioChannel.Mono;

// Start
ZegoExpressEngine.getEngine().SetAudioDataHandler(handler);
ZegoExpressEngine.getEngine().StartAudioDataObserver(bitmask, param);

// Stop
ZegoExpressEngine.getEngine().SetAudioDataHandler(null);
ZegoExpressEngine.getEngine().StopAudioDataObserver();
```

### SetBuiltInSpeakerOn

#### 3.0.0 版本前

```cs
ZegoExpressEngine.GetEngine().SetBuiltInSpeakerOn(true);
```


#### 3.0.0 版本及以上

```cs
ZegoExpressEngine.GetEngine().SetAudioRouteToSpeaker(true);
```

### OnDeviceError

#### 3.0.0 版本前


```cs
public void OnDeviceError(int errorCode, string deviceName) {
    // Handle device error
    // 处理设备错误
}
engine.onDeviceError = OnDeviceError;
```

#### 3.0.0 版本及以上

```cs
public void OnLocalDeviceExceptionOccurred(ZegoDeviceExceptionType exceptionType, ZegoDeviceType deviceType, string deviceID) {
    // Handle device error
    // 处理设备错误
}

engine.onLocalDeviceExceptionOccurred = OnLocalDeviceExceptionOccurred;
```
