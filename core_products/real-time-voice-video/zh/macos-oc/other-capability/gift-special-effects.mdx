---
articleID: 17568
---
# 播放透明礼物特效

- - -
## 功能简介

@@@gift_special_effects_info@@@


## 示例源码


请参考 [下载示例源码](!DownloadDemo/DownloadDemo) 获取源码。

相关源码请查看 “/ZegoExpressExample/Examples/Others/MediaPlayer” 目录下的文件。


## 前提条件

在使用媒体播放器播放 MP4 动态效果，即实现播放透明礼物特效之前，请确保：

@@@Express-Video_Prerequisites@@@



## 实现流程

### 1 输出素材

@@@Express_gift_special_effects_step1@@@

### 2 创建媒体播放器

调用 [createMediaPlayer](@createMediaPlayer) 创建媒体播放器。调用 [setPlayerCanvas](@setPlayerCanvas-ZegoMediaPlayer) 设置播放器 canvas 的 `alphaBlend` 属性为 `YES`。

```oc
ZegoCanvas *canvas = [ZegoCanvas canvasWithView:self.mediaPlayerView];
canvas.alphaBlend = YES;//支持 Alpha 通道渲染
[self.mediaPlayer setPlayerCanvas:canvas];
```

### 3 加载素材

调用 [createMediaPlayer](@createMediaPlayer) 创建媒体播放器后，通过 [loadResourceWithConfig](@loadResourceWithConfig-ZegoMediaPlayer) 接口，通过**文件路径**或**二进制内存数据**，播放拼接后的特效素材。

<div class="mk-warning">

虽然 [loadResourceWithConfig](@loadResourceWithConfig-ZegoMediaPlayer) 接口支持通过版权音乐资源 ID 加载多媒体资源，但是版权音乐目前不支持视频，因此无法通过版权音乐资源 ID 加载方式来加载礼物特效。
</div>

<div class="multiple-select-codes">
    <div class="code-tabs hide-scrollbar">
      <div class="scroll-box">
        <span class="tab-item">
          <span>通过文件路径加载</span>
        </span>
        <span class="tab-item">
          <span>通过二进制内存数据加载</span>
        </span>
      </div>
    </div>

  <div class="code-list">
  
  ```objc
  ZegoMediaPlayerResource *resource = [[ZegoMediaPlayerResource alloc]init];
  resource.loadType = ZegoMultimediaLoadTypeFilePath;//加载方式选择文件路径加载
  resource.filePath = @"fileURL";//文件路径
  resource.alphaLayout = ZegoAlphaLayoutTypeLeft;//根据实际资源选择 Alpha 通道布局
  [self.mediaPlayer loadResourceWithConfig:resource callback:^(int errorCode) {
      //资源加载结果
      // 可执行更新 UI 等逻辑
      if (errorCode == 0) {
          //加载文件成功，此时可以开始播放媒体资源
          [self.mediaPlayer start];
      }
  }];
  ```

  ```objc
  ZegoMediaPlayerResource *resource = [[ZegoMediaPlayerResource alloc]init];
  resource.loadType = ZegoMultimediaLoadTypeMemory;//加载方式选择二进制内存数据加载
  resource.memory = [NSData dataWithContentsOfFile:@"fileURL"];//资源文件
  resource.memoryLength = (int)[resource.memory length];//资源文件长度
  resource.alphaLayout = ZegoAlphaLayoutTypeLeft;//根据实际资源选择 Alpha 通道布局
  [self.mediaPlayer loadResourceWithConfig:resource callback:^(int errorCode) {
      //资源加载结果
      // 可执行更新 UI 等逻辑
      if (errorCode == 0) {
          //加载文件成功，此时可以开始播放媒体资源
          [self.mediaPlayer start];
      }
  }];
  ```
  
  </div>
</div>

### 4 播放素材

在调用 [loadResourceWithConfig](@loadResourceWithConfig-ZegoMediaPlayer) 加载文件成功后，可调用 [start](@start-ZegoMediaPlayer)、[pause](@pause-ZegoMediaPlayer)、[resume](@resume-ZegoMediaPlayer)、[stop](@stop-ZegoMediaPlayer) 来启停播放。一旦播放器的内部状态改变，[ZegoMediaPlayer](@-ZegoMediaPlayer) 的 [stateUpdate](/article/api?doc=Express_Video_SDK_API~objective-c_ios~protocol~ZegoMediaPlayerEventHandler) 回调将会被触发。

用户也可通过调用 [currentState](@currentState-ZegoMediaPlayer) 随时获取播放器的当前状态。

如果 [enableRepeat](@enableRepeat-ZegoMediaPlayer) 设置为 `YES`，则播放器会在播放完文件后自动重播。

```objc
// 开始播放，播放之前需要先调用接口加载媒体文件
[self.mediaPlayer start];
// 暂停
[self.mediaPlayer pause];
// 恢复
[self.mediaPlayer resume];
// 停止
[self.mediaPlayer stop];
```
