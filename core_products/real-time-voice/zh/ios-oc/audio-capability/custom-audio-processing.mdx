---
articleID: 5089
---
# 自定义音频处理

## 1 功能简介

自定义音频处理一般用于去除语音中的干扰，由于 SDK 已经对采集的音频原始数据进行了回声消除、噪声抑制等处理，通常情况下，开发者无需再重复处理。

如果开发者想在采集音频数据后或拉取远端音频数据渲染前，通过自定义处理实现特殊功能时（例如变声、美声等），可以参考本文档。


## 2 前提条件

在自定义音频处理之前，请确保：

- 已在项目中集成 ZEGO Express SDK，实现基本的实时语音功能，详情请参考 [快速开始 - 集成\|_blank](!ExpressAudioSDK-Integration/SDK_Integration) 和 [快速开始 - 实现流程\|_blank](!ExpressAudioSDK-Integration/Solution_Implementation)。
- 已在 [ZEGO 控制台\|_blank](https://console.zego.im) 创建项目，并申请有效的 AppID 和 AppSign，详情请参考 [控制台 - 项目管理\|_blank](#12107) 中的“项目信息”。


## 3 使用步骤

### 3.1 创建 SDK 引擎

调用 [createEngine ](/zh/api?doc=Express_Video_SDK_API~ObjectiveC~class~zego-express-engine#create-engine-with-app-id-app-sign-is-test-env-scenario-event-handler) 接口创建 SDK 引擎实例，详情请参考 [快速开始 - 实现流程](7628#3_1) 的 “3.1 创建引擎”。

```objc
ZegoEngineProfile *profile = [[ZegoEngineProfile alloc] init];
profile.appID = [KeyCenter appID];
profile.appSign = [KeyCenter appSign];
profile.scenario = ZegoScenarioGeneral;
[ZegoExpressEngine createEngineWithProfile:profile eventHandler:nil];
```
### 3.2 设置音频自定义处理对象并实现回调方法

调用 [setCustomAudioProcessHandler](/zh/api?doc=Express_Video_SDK_API~ObjectiveC~class~zego-express-engine#set-custom-audio-process-handler) 接口设置音频自定义处理对象，并实现回调方法。

```objc
[[ZegoExpressEngine sharedEngine] setCustomAudioProcessHandler:self];
- (void)onProcessCapturedAudioData:(unsigned char *)data dataLength:(unsigned int)dataLength param:(ZegoAudioFrameParam *)param {

}

- (void)onProcessRemoteAudioData:(unsigned char *)data dataLength:(unsigned int)dataLength param:(ZegoAudioFrameParam *)param streamID:(NSString *)streamID {

}
```


### 3.3 自定义音频处理

- 在开始推流或启动本地预览前调用 [enableCustomAudioCaptureProcessing ](/zh/api?doc=Express_Video_SDK_API~ObjectiveC~class~zego-express-engine#enable-custom-audio-capture-processing-config) 接口开启**本地采集**自定义音频处理。开启后，开发者可以通过 [onProcessCapturedAudioData ](/zh/api?doc=Express_Video_SDK_API~ObjectiveC~protocol~zego-custom-audio-process-handler#on-process-captured-audio-data-data-length-param) 回调收到本地采集的音频帧，并可以对音频数据进行修改。

- 在开始拉流或启动本地预览前调用 [enableCustomAudioRemoteProcessing ](/zh/api?doc=Express_Video_SDK_API~ObjectiveC~class~zego-express-engine#enable-custom-audio-remote-processing-config) 接口开启**远端拉流**自定义音频处理。开启后，开发者可以通过 [onProcessRemoteAudioData ](/zh/api?doc=Express_Video_SDK_API~ObjectiveC~protocol~zego-custom-audio-process-handler#on-process-remote-audio-data-data-length-param-stream-id) 收到远端拉流的音频帧，并且可以对音频数据进行修改。


```objc
ZegoCustomAudioProcessConfig *config = [[ZegoCustomAudioProcessConfig alloc] init];
config.channel = ZegoAudioChannelMono;
config.sampleRate = ZegoAudioSampleRate16K;
config.samples = 0;

[[ZegoExpressEngine sharedEngine] enableCustomAudioCaptureProcessing:YES config:config];
[[ZegoExpressEngine sharedEngine] enableCustomAudioRemoteProcessing:YES config:config];
```

## 4 API 参考列表

| 方法     | 描述 |
| ------- | -------- |
| [createEngine ](/zh/api?doc=Express_Video_SDK_API~ObjectiveC~class~zego-express-engine#create-engine-with-app-id-app-sign-is-test-env-scenario-event-handler) | 创建引擎单例对象           |
| [setCustomAudioProcessHandler ](/zh/api?doc=Express_Video_SDK_API~ObjectiveC~class~zego-express-engine#set-custom-audio-process-handler) | 设置自定义音频渲染回调     |
| [enableCustomAudioCaptureProcessing ](/zh/api?doc=Express_Video_SDK_API~ObjectiveC~class~zego-express-engine#enable-custom-audio-capture-processing-config) | 开启本地采集自定义音频处理 |
| [enableCustomAudioRemoteProcessing ](/zh/api?doc=Express_Video_SDK_API~ObjectiveC~class~zego-express-engine#enable-custom-audio-remote-processing-config) | 开启远端拉流自定义音频处理 |
