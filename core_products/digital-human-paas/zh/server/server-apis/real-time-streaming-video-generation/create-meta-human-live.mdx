

# 创建数字人视频流任务

---

## 描述

调用本接口创建一个数字人视频流任务，配置数字人形象、素材、背景、视频参数及视频流任务时长等参数。调用此接口后，数字人相关的视觉元素即可出现在画面。但此时数字人还不能说话，如需实现数字人语音，请参考 [驱动数字人\|_blank](#18555)。

<Note title="Note">

本服务端接口仅支持向 ZEGO RTC 房间推流，需要搭配 [实时音视频\|_blank](#195) 一起使用。
</Note>

## 接口原型

- 请求方法：POST
- 中国大陆正式环境请求地址：https://aigc-api.zegotech.cn/?Action=CreateMetaHumanLive
- 传输协议：HTTPS
- 调用频率限制：10 次/秒


## 请求参数

以下请求参数列表仅列出了接口请求参数，公共参数列表请参考 [调用方式 - 公共请求参数\|_blank](#18534#4_1)。

<table class="collapsible-table" >
  
<tbody><tr data-row-level="1">
<th>参数</th>
<th>类型</th>
<th>是否必选</th>
<th>描述</th>
</tr>
<tr data-row-level="2">
<td>StreamType</td>
<td>String</td>
<td>否</td>
<td>流类型: rtc（默认）、rtmp</td>
</tr>
<tr data-row-level="3">
<td>RtmpUrl</td>
<td>String</td>
<td>若 StreamType 为 rtmp 时，必填</td>
<td>rtmp 流地址，用户自定义传入。</td>
</tr>
<tr data-row-level="4">
<td>RoomId</td>
<td>String</td>
<td>是</td>
<td>推流到指定房间 ID，长度在 128 字节以内，用户自定义传入。</td>
</tr>
<tr data-row-level="5">
<td>StreamId</td>
<td>String</td>
<td>是</td>
<td>流 ID，长度在 256 字节以内，仅支持数字，英文字符 和 ‘-’，’_’。
请注意，StreamId 必须是 AppID 全局内唯一，用户自定义传入。</td>
</tr>
<tr data-row-level="6" data-row-child="true">
<td>MetaHuman</td>
<td>Object</td>
<td>是</td>
<td>数字人形象配置。</td>
</tr>
<tr data-row-level="6-1">
<td>MetaHumanId</td>
<td>String</td>
<td>是</td>
<td>数字人形象 ID，通过&nbsp;[查询数字人模特列表|_blank](!DescribeMetaHumanModel)&nbsp;获得。</td>
</tr>
<tr data-row-level="6-2" data-row-child="true">
<td>Layout</td>
<td>Object</td>
<td>是</td>
<td>数字人形象布局。</td>
</tr>
<tr data-row-level="6-2-1">
<td>Top</td>
<td>Int</td>
<td>是</td>
<td>布局左上角的 y 轴坐标。</td>
</tr>
<tr data-row-level="6-2-2">
<td>Left</td>
<td>Int</td>
<td>是</td>
<td>布局左上角的 x 轴坐标。</td>
</tr>
<tr data-row-level="6-2-3">
<td>Width</td>
<td>Int</td>
<td>是</td>
<td>布局宽度。</td>
</tr>
<tr data-row-level="6-2-4">
<td>Height</td>
<td>Int</td>
<td>是</td>
<td>布局高度。</td>
</tr>
<tr data-row-level="6-2-5">
<td>Layer</td>
<td>Int</td>
<td>否</td>
<td>图层，必须大于等于 0，数值越大则图层越靠前。</td>
</tr>
<tr data-row-level="7" data-row-child="true">
<td>Assets</td>
<td>Array of Object</td>
<td>否</td>
<td>素材配置。</td>
</tr>
<tr data-row-level="7-1">
<td>AssetType</td>
<td>Int</td>
<td>是</td>
<td>素材类型。
1：图片。</td>
</tr>
<tr data-row-level="7-2">
<td>AssetUrl</td>
<td>String</td>
<td>是</td>
<td>素材 URL，用户自定义传入。</td>
</tr>
<tr data-row-level="7-3" data-row-child="true">
<td>Layout</td>
<td>Object</td>
<td>是</td>
<td>素材布局。</td>
</tr>
<tr data-row-level="7-3-1">
<td>Top</td>
<td>Int</td>
<td>是</td>
<td>距离输出画布上边框的像素大小。</td>
</tr>
<tr data-row-level="7-3-2">
<td>Left</td>
<td>Int</td>
<td>是</td>
<td>距离输出画布左边框的像素大小。</td>
</tr>
<tr data-row-level="7-3-3">
<td>Width</td>
<td>Int</td>
<td>是</td>
<td>布局宽度。</td>
</tr>
<tr data-row-level="7-3-4">
<td>Height</td>
<td>Int</td>
<td>是</td>
<td>布局高度。</td>
</tr>
<tr data-row-level="7-3-5">
<td>Layer</td>
<td>Int</td>
<td>否</td>
<td>图层，必须大于等于 0，数值越大则图层越靠前。</td>
</tr>
<tr data-row-level="8">
<td>BackgroundColor</td>
<td>String</td>
<td>否</td>
<td>背景颜色，十六进制的 RGB 值，格式如“#ffffff”，默认值为“#000000”（黑色）。<br />
注意：图片数字人不支持该字段。</td>
</tr>
<tr data-row-level="9" data-row-child="true">
<td>VideoOption</td>
<td>Object</td>
<td>是</td>
<td>视频参数配置。</td>
</tr>
<tr data-row-level="9-1">
<td>Width</td>
<td>Int</td>
<td>是</td>
<td>视频流分辨率，宽，不超过 2560，且 Width 和 Height 的乘积不超过 2560 * 1440。</td>
</tr>
<tr data-row-level="9-2">
<td>Height</td>
<td>Int</td>
<td>是</td>
<td>视频流分辨率，高，不超过 2560，且 Width 和 Height 的乘积不超过 2560 * 1440。</td>
</tr>
<tr data-row-level="10">
<td>MaxLiveTime</td>
<td>Int</td>
<td>否</td>
<td>数字人视频流任务最大时长，持续时间达到该值自动结束。
单位为秒，默认值 86400 秒（24 小时），最大不超过 86400（24 小时）。</td>
</tr>
<tr data-row-level="11">
<td>BackgroundMode</td>
<td>Int</td>
<td>否</td>
<td>- 0：默认背景。
- 1：开启背景透明通道。

<Warning title="Warning"><p></p><ul><li>仅当开发者使用原生平台 Express SDK 拉流时，才可以实现背景透明通道。</li>
<li>原生平台开发者在接入 Express SDK 过程中，如果有背景叠加渲染需求，在本参数设置为 1（开启背景透明通道）后，需在 ZegoCanvas 对象下开启 alphaBlend（允许 Alpha 混合图层渲染，默认关闭，需手动开启） 即可。</li></ul><p></p></Warning></td>
</tr>
</tbody></table>

## 请求示例

- 请求 URL  

    ```
    https://aigc-api.zegotech.cn/?Action=CreateMetaHumanLive
    &AppId=1234567890
    &SignatureNonce=15215528852396
    &Timestamp=1234567890
    &Signature=7a2c0f11145fb760d607a07b54825013
    &SignatureVersion=2.0
    ```

- 请求消息体  

    ```json
    {
        "StreamType": "rtc",
        "RtmpUrl": "",
        "StreamId": "your_stream_id",
        "MetaHuman": {
            "MetaHumanId": "your_meta_human_id",
            "Layout": {
                "Top": 191,
                "Left": 100,
                "Width": 506,
                "Height": 900,
                "Layer": 0
            }
        },
        "BackgroundColor": "#000000",
        "VideoOption": {
            "Width": 1280,
            "Height": 720
        },
        "MaxLiveTime": 3600,
        "BackgroundMode": 0
    }
    ```

## 响应参数

<table class="collapsible-table" >
  
<tbody><tr data-row-level="1">
<th>参数</th>
<th>类型</th>
<th>描述</th>
</tr>
<tr data-row-level="2">
<td>Code</td>
<td>Int</td>
<td>错误码。</td>
</tr>
<tr data-row-level="3">
<td>Message</td>
<td>String</td>
<td>错误描述。</td>
</tr>
<tr data-row-level="4" data-row-child="true">
<td>Data</td>
<td>Object</td>
<td>响应对象。</td>
</tr>
<tr data-row-level="4-1">
<td>TaskId</td>
<td>String</td>
<td>数字人视频流任务 ID，查询时使用。</td>
</tr>
</tbody></table>


## 响应示例

``` json
{
    "Code": 0,
    "Message": "succeed",
    "Data": {
        "TaskId": "XXXXXXXXXXXX",
    }
}
```

## 返回码

以下仅列出了常见的接口业务逻辑相关的返回码，完整返回码请参考 [全局返回码\|_blank](#18574)。

| 返回码 | 说明 | 处理建议 |
| -- | -- | -- |
| 0 | 成功。| -|
| 100000004 | 签名过期。| 请重新生成签名。|
| 100000005 | 签名错误。| 请确认生成签名的参数是否正确。|
| 400000001 | 输入参数无效。| 请根据 Message 提示，调整对应参数的取值。|
| 400000002 | 数字人 PaaS 服务权限未开通。| 请联系 ZEGO 技术支持开通服务权限。|
| 400000003 | 未找到数字人形象。| 请确认设置的 MetaHumanId 是否正确。|
| 400000008 | 并发数超出限制。| 请确认当前创建的并发数量是否超过上限。|
| 400000010 | 数字人形象内部配置出错问题。| 可先使用其他 MetaHumanId 及时创建视频流任务，随后联系 ZEGO 技术支持调整内部配置。|
| 400000015 | 当前流 ID 已存在。| 请更换流 ID 或结束当前流任务。|
| 400000016 | 数字人模型版本错误。| 请联系 ZEGO 技术支持处理。|
| 400010000 | 系统错误。| 请联系 ZEGO 技术支持处理。|
| 400010001 | 未获得接口调用权限。| 请联系 ZEGO 技术支持开通服务权限。|
| 400010002 | 资源不足。| 请稍后重试。|
