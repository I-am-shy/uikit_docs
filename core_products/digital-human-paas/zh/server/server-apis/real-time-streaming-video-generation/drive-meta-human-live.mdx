

# 驱动数字人

---

## 描述

调用本接口，配置数字人语音驱动方式、音色、语速、语调和音量，驱动数字人说话。

## 接口原型

- 请求方法：POST
- 中国大陆正式环境请求地址：https://aigc-api.zegotech.cn/?Action=DriveMetaHumanLive
- 传输协议：HTTPS
- 调用频率限制：10 次/秒


## 请求参数

以下请求参数列表仅列出了接口请求参数，公共参数列表请参考 [调用方式 - 公共请求参数\|_blank](#18534#4_1)。

<table class="collapsible-table" >
  
<tbody><tr data-row-level="1">
<th>参数</th>
<th>类型</th>
<th>是否必选</th>
<th>描述</th>
</tr>
<tr data-row-level="2">
<td>TaskId</td>
<td>String</td>
<td>是</td>
<td>数字人视频流任务 ID，[创建数字人视频流任务|_blank](!CreateMetaHumanLive) 后获取。</td>
</tr>
<tr data-row-level="3" data-row-child="true">
<td>Driver</td>
<td>Object</td>
<td>是</td>
<td>驱动配置。</td>
</tr>
<tr data-row-level="3-1">
<td>DriverType</td>
<td>Int</td>
<td>是</td>
<td>驱动方式：<ul><li>1：文本驱动。</li><li>2：音频文件驱动。</li><li>3：静音驱动。此时数字人只有动作没有声音。</li><li>4：实时音频流驱动。</li></ul></td>
</tr>
<tr data-row-level="3-2">
<td>TimbreId</td>
<td>String</td>
<td>否</td>
<td>音色 ID，DriverType 为 1 时，必填。可通过 [查询音色列表|_blank](!DescribeTimbreByMetaHuman)，了解当前数字人支持的音色。</td>
</tr>
<tr data-row-level="3-3">
<td>Text</td>
<td>String</td>
<td>否</td>
<td>文本内容，DriverType 为 1 时，必填。不超过 1800 个字。支持 [SSML标记语言|_blank](https://zegocloud.feishu.cn/docx/GZV2dcmq4o0hFOxoXEBcIvdynDb)。</td>
</tr>
<tr data-row-level="3-4">
<td>SpeechRate</td>
<td>Int</td>
<td>否</td>
<td>语速，取值范围为 [-500, 500]，默认值 0。数值越大，声音越快。</td>
</tr>
<tr data-row-level="3-5">
<td>PitchRate</td>
<td>Int</td>
<td>否</td>
<td>语调，取值范围为 [-500, 500]，默认值 0。数值越大，声音越尖。</td>
</tr>
<tr data-row-level="3-6">
<td>Volume</td>
<td>Int</td>
<td>否</td>
<td>音量，取值范围为 [1, 100]，默认值 50。数值越大，声音越大。</td>
</tr>
<tr data-row-level="3-7">
<td>AudioUrl</td>
<td>String</td>
<td>否</td>
<td>音频 URL 绝对链接（音频格式支持 MP3 和 WAV 文件），DriverType 为 2 时，必填，用户自定义传入。</td>
</tr>
<tr data-row-level="3-8">
<td>Strategy</td>
<td>Int</td>
<td>否</td>
<td>打断策略：<ul><li>0：（默认）排队等待前面的驱动任务完成后，再执行本驱动任务。</li><li>1：中断当前语音，立即执行本驱动任务。</li></ul></td>
</tr>
<tr data-row-level="3-9" data-row-child="true">
<td>Actions</td>
<td>Array of Object</td>
<td>否</td>
<td>插入动作，比如摊手、合上、打招呼等动作。
<ul><li>DriverType 为 1 时选填。</li><li>DriverType 为 2 和 4 时不生效。</li><li>DriverType 为 3 时必填。</li></ul></td>
</tr>
<tr data-row-level="3-9-1">
<td>ActionName</td>
<td>String</td>
<td>否</td>
<td>插入动作的名称，需联系 ZEGO 技术支持获取。</td>
</tr>
<tr data-row-level="3-9-2">
<td>StartPos</td>
<td>int</td>
<td>否</td>
<td>动作插入的位置。<ul><li>DriverType 为 1 时，表示在第几个字后插入。</li><li>DriverType 为 3 时，此字段不生效，立即插入。</li></ul></td>
</tr>
<tr data-row-level="3-10">
<td>RTCProvider</td>
<td>String</td>
<td>否</td>
<td>DriverType 为 4 时必传，实时语音驱动的 RTC 厂商，当前仅支持 zego。</td>
</tr>
<tr data-row-level="3-11" data-row-child="true">
<td>RTCOptions</td>
<td>Object</td>
<td>否</td>
<td>DriverType 为 4 时必传，ZEGO RTC 驱动相关参数。</td>
</tr>
<tr data-row-level="3-11-1">
<td>RoomId</td>
<td>String</td>
<td>是</td>
<td>驱动音频流所在的 RTC 房间 ID。</td>
</tr>
<tr data-row-level="3-11-2">
<td>StreamId</td>
<td>String</td>
<td>是</td>
<td>驱动音频流的流 ID。</td>
</tr>
<tr data-row-level="3-11-3">
<td>UserId</td>
<td>String</td>
<td>否</td>
<td>进入 RTC 房间，开发者需自定义拉取驱动音频流的用户 ID（保证房间内唯一，且不能与驱动音频流的流 ID 相同），该 UserId 仅用于在后台拉取驱动音频流，无实际意义。若不自定义系统将自动生成 UserId 用于拉取驱动音频流。</td>
</tr>
</tbody></table>

## 请求示例

- 请求 URL  

    ```
    https://aigc-api.zegotech.cn/?Action=DriveMetaHumanLive
    &AppId=1234567890
    &SignatureNonce=15215528852396
    &Timestamp=1234567890
    &Signature=7a2c0f11145fb760d607a07b54825013
    &SignatureVersion=2.0
    ```

- 请求消息体  

    ```json
    {
        "TaskId": "8873388e-1710-4573-bffd-6df25fd4cb0f",
        "Driver": {
            "DriverType": 1,
            "TimbreId": "your_timebre_id",
            "Text": "时维九月，序属三秋。潦水尽而寒潭清，烟光凝而暮山紫。俨骖騑于上路，访风景于崇阿。临帝子之长洲，得天人之旧馆。层峦耸翠，上出重霄；飞阁流丹，下临无地。鹤汀凫渚，穷岛屿之萦回；桂殿兰宫，即冈峦之体势。",
            "Actions": [
               {
                  "ActionName": "action_hello",
                  "StartPos": 1
               }
            ]
        }
    }
    ```

## 响应参数

<table class="collapsible-table" >
  
<tbody><tr data-row-level="1">
<th>参数</th>
<th>类型</th>
<th>描述</th>
</tr>
<tr data-row-level="2">
<td>Code</td>
<td>Int</td>
<td>错误码。</td>
</tr>
<tr data-row-level="3">
<td>Message</td>
<td>String</td>
<td>错误描述。</td>
</tr>
<tr data-row-level="4" data-row-child="true">
<td>Data</td>
<td>Object</td>
<td>响应对象。</td>
</tr>
<tr data-row-level="4-1">
<td>DriverTaskId</td>
<td>String</td>
<td>驱动数字人任务 ID，[查询驱动任务状态\|_blank](!DescribeMetaHumanLiveDriver) 时使用。</td>
</tr>
</tbody></table>


## 响应示例


``` json
{
    "Code": 0,
    "Message": "succeed",
    "Data": {
        "DriverTaskId": "XXXXXXXXXXXX",
    }
}
```

## 返回码

以下仅列出了常见的接口业务逻辑相关的返回码，完整返回码请参考 [全局返回码\|_blank](#18574)。

| 返回码 | 说明 | 处理建议 |
| -- | -- | -- |
| 0 | 成功。| -|
| 100000004 | 签名过期。| 请重新生成签名。|
| 100000005 | 签名错误。| 请确认生成签名的参数是否正确。|
| 400000001 | 输入参数无效。| 请根据 Message 提示，调整对应参数的取值。|
| 400000002 | 数字人 PaaS 服务权限未开通。| 请联系 ZEGO 技术支持开通服务权限。|
| 400000004 | 未找到音色。 | 请确认设置的 TimbreId 是否正确。|
| 400000005 | 未找到任务。 | 请确认设置的 TaskId 是否正确。 |
| 400000006 | 数字人视频流任务未开始。| 请等待数字人视频流任务开始后再进行操作。|
| 400000009 | 数字人视频流任务不支持当前音色。| 请使用其它音色。|
| 400010000 | 系统错误。| 请联系 ZEGO 技术支持处理。|
