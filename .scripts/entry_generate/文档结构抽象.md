# 文档结构抽象

基于对docuo.config.json和sidebars.json的分析，这3个产品的entry文档结构可以抽象如下：

## 1. 整体架构

### 1.1 产品层级
- **实时音视频** (real-time-voice-video) - 支持全球超低延迟多人视频、音频互动
- **实时语音** (real-time-voice) - 支持全球超低延迟、超高音质的音频通话  
- **超低延迟直播** (low-latency-live-streaming) - 为高质量体验而生的直播分发产品

### 1.2 平台层级
每个产品支持多个平台，以iOS为例：
- `ios-oc` (iOS Objective-C)
- `ios-swift` (iOS Swift)

### 1.3 文档实例配置
在docuo.config.json中，每个产品+平台组合都有独立的instance配置：
```json
{
  "id": "real_time_video_ios_oc_zh",
  "label": "实时音视频 (iOS Objective-C)",
  "path": "core_products/real-time-voice-video/zh/ios-oc",
  "routeBasePath": "real-time-video-ios-oc",
  "locale": "zh",
  "navigationInfo": {
    "group": {
      "id": "real_time_video_zh",
      "name": "实时音视频",
      "tag": "Hot"
    },
    "category": ["产品", "互动核心产品"],
    "tab": "文档",
    "platform": "iOS: Objective-C"
  }
}
```

## 2. Entry文档结构

### 2.1 产品级别内容（区分产品，不区分平台）
这部分内容在3个产品间有差异，但在同一产品的不同平台间保持一致：

#### 标题和描述
- **实时音视频**: 支持全球超低延迟多人视频、音频互动，为开发者提供便捷接入、高可靠、多平台互通的音视频服务
- **实时语音**: 支持全球超低延迟、超高音质的音频通话，为开发者提供便捷接入、高可靠、多平台互通的音视频服务  
- **超低延迟直播**: 为高质量体验而生，直播分发产品中的"六边形战士"，打造超低延迟、超强同步、抗极端弱网、超低卡顿、超清画质、首帧秒开的极致体验

#### 快捷按钮
- 下载 SDK
- 快速开始 
- 客户端 API
- 服务端 API

### 2.2 平台级别内容（基于sidebars.json生成）
这部分内容根据对应产品平台的sidebars.json文件动态生成Steps组件：

#### Steps组件结构映射
sidebars.json中的category → entry.mdx中的Step

**通用Step模式**：
1. **产品介绍** - 对应sidebars中的"产品简介"category
2. **快速开始** - 对应sidebars中的"快速开始"category  
3. **通信能力** - 对应sidebars中的"通信能力"category
4. **房间能力** - 对应sidebars中的"房间能力"category
5. **音频能力** - 对应sidebars中的"音频能力"category
6. **视频能力** - 对应sidebars中的"视频能力"category（实时语音产品无此模块）
7. **直播能力** - 对应sidebars中的"直播能力"category
8. **其他能力** - 对应sidebars中的"其他能力"category
9. **最佳实践** - 对应sidebars中的"最佳实践"category
10. **参考文档** - 对应sidebars中的"API 参考文档"category

#### 特殊处理
- **超低延迟直播**产品的Steps顺序有调整：直播能力放在通信能力之前
- **实时语音**产品没有"视频能力"模块
- 每个Step内的FeatureList根据sidebars.json中对应category的items生成
- 支持tag标记（Hot、New等）和分类（基础、进阶）

## 3. 数据流转换规则

### 3.1 从sidebars.json到FeatureList的转换
```javascript
// sidebars.json结构
{
  "type": "category",
  "label": "通信能力", 
  "items": [
    {
      "type": "doc",
      "label": "使用 Token 鉴权",
      "id": "communication/using-token-authentication",
      "tag": { "label": "基础", "color": "Check" }
    }
  ]
}

// 转换为FeatureList
<FeatureList
  type="基础"
  features={[
    { 
      title: "使用 Token 鉴权", 
      tag: "Hot", 
      tag_color: "red", 
      link: "/real-time-video-ios-oc/communication/using-token-authentication" 
    }
  ]}
/>
```

### 3.2 链接路径生成规则
- 基础路径：docuo.config.json中的routeBasePath
- 文档路径：sidebars.json中的id
- 完整链接：`/${routeBasePath}/${id}`

### 3.3 标签映射规则
- sidebars中的tag.label="基础" → FeatureList的type="基础"
- 特殊标签：Hot、New等直接映射到tag和tag_color

## 4. 产品配置映射

### 4.1 产品元数据配置
```javascript
const PRODUCT_CONFIG = {
  "real-time-voice-video": {
    name: "实时音视频",
    icon: "https://doc-media.zego.im/sdk-doc/Pics/DeveloperCenter/homePage/product_img/icon_shishiyinshipin.png",
    description: "支持全球超低延迟多人视频、音频互动，为开发者提供便捷接入、高可靠、多平台互通的音视频服务。",
    apiPaths: {
      client: "/real-time-voice-video-api/overview",
      server: "/real-time-video-server/api-reference/overview"
    },
    hasVideoCapability: true
  },
  "real-time-voice": {
    name: "实时语音",
    icon: "https://doc-media.zego.im/sdk-doc/Pics/DeveloperCenter/homePage/product_img/icon_shishiyuyin.png",
    description: "支持全球超低延迟、超高音质的音频通话，为开发者提供便捷接入、高可靠、多平台互通的音视频服务。",
    apiPaths: {
      client: "/real-time-voice-api/overview",
      server: "/real-time-voice-server/api-reference/overview"
    },
    hasVideoCapability: false
  },
  "low-latency-live-streaming": {
    name: "超低延迟直播",
    icon: "https://zego-public-develop-center.oss-cn-shanghai.aliyuncs.com/homePageData/image/ico_live_streaming.png",
    description: "为高质量体验而生，直播分发产品中的"六边形战士"，打造超低延迟、超强同步、抗极端弱网、超低卡顿、超清画质、首帧秒开的极致体验。",
    apiPaths: {
      client: "/live-streaming-api/overview",
      server: "/live-streaming-server/api-reference/overview"
    },
    hasVideoCapability: true,
    stepOrder: ["产品介绍", "快速开始", "直播能力", "通信能力", "房间能力", "音频能力", "视频能力", "其他能力", "最佳实践", "参考文档"]
  }
}
```

### 4.2 Step图标配置
```javascript
const STEP_ICONS = {
  "产品介绍": "https://doc-media.zego.im/sdk-doc/Pics/Express/overview_catalog/icon_documentation_jianjie.png",
  "快速开始": "https://doc-media.zego.im/sdk-doc/Pics/Express/overview_catalog/icon_documentation_kuaisukaishi.png",
  "通信能力": "https://doc-media.zego.im/sdk-doc/Pics/Express/overview_catalog/icon_documentation_tongxun.png",
  "房间能力": "https://doc-media.zego.im/sdk-doc/Pics/Express/overview_catalog/icon_documentation_fangjian.png",
  "音频能力": "https://doc-media.zego.im/sdk-doc/Pics/Express/overview_catalog/icon_documentation_yinpin.png",
  "视频能力": "https://doc-media.zego.im/sdk-doc/Pics/Express/overview_catalog/icon_documentation_shipin.png",
  "直播能力": "https://doc-media.zego.im/sdk-doc/Pics/Express/overview_catalog/icon_documentation_zhibo.png",
  "其他能力": "https://doc-media.zego.im/sdk-doc/Pics/Express/overview_catalog/icon_documentation_xiaoxi_2.png",
  "最佳实践": "https://doc-media.zego.im/sdk-doc/Pics/Express/overview_catalog/icon_documentation_zuijiashijian.png",
  "参考文档": "https://doc-media.zego.im/sdk-doc/Pics/Express/overview_catalog/icon_documentation_cankaowendang.png"
}
```

## 5. 自动化生成策略

### 5.1 生成流程
1. **读取配置**: 从docuo.config.json获取产品实例配置
2. **解析sidebars**: 读取对应平台的sidebars.json文件
3. **生成头部**: 根据产品配置生成标题、描述、按钮
4. **生成Steps**: 根据sidebars结构和产品特性生成Steps组件
5. **输出文件**: 生成完整的entry.mdx文件

### 5.2 核心生成函数
```javascript
function generateEntryFile(productType, platform, locale) {
  const productConfig = PRODUCT_CONFIG[productType];
  const instanceConfig = getInstanceConfig(productType, platform, locale);
  const sidebarData = loadSidebars(productType, platform, locale);

  return {
    header: generateHeader(productConfig, instanceConfig),
    steps: generateSteps(sidebarData, productConfig, instanceConfig)
  };
}

function generateSteps(sidebarData, productConfig, instanceConfig) {
  const stepOrder = productConfig.stepOrder || DEFAULT_STEP_ORDER;
  return stepOrder
    .filter(stepName => shouldIncludeStep(stepName, productConfig))
    .map(stepName => generateStep(stepName, sidebarData, instanceConfig));
}
```

### 5.3 特殊处理规则
- **实时语音产品**: 跳过"视频能力"Step
- **超低延迟直播**: 使用自定义的stepOrder
- **标签映射**: Hot/New标签优先级高于基础/进阶分类
- **链接生成**: 自动拼接routeBasePath和文档id

## 6. 维护优势

通过这种抽象结构：
1. **一致性**: 所有产品和平台的entry文档结构保持一致
2. **可维护性**: 修改sidebars.json自动反映到entry文档
3. **可扩展性**: 新增产品或平台只需添加配置
4. **自动化**: 减少手工维护，降低错误率

这样的抽象使得entry文档可以通过配置驱动的方式自动生成，确保一致性和可维护性。
