# 背景虚化及虚拟背景
- - -
## 功能概述
在通话过程中，如需将视频画面中的主体从原始画面中分离出来，实现背景虚化及虚拟背景效果，可参考本文档。

### 兼容性

支持背景虚化及虚拟背景功能的浏览器如下表：

| 浏览器 | 兼容版本 |
|  ----  | ----  |
|Google Chrome	| 90 及以上|
|Firefox | 111 及以上|
|Safari | 15 及以上 |
|移动端浏览器| 不支持 |
|微信内嵌网页| 不支持 |

### 注意事项

- 背景虚化及虚拟背景功能对设备性能有较高要求，建议在满足以下条件的设备上开启虚拟背景功能：
    - 配备 Core i5 或以上 CPU。
    - 配备 8GB 或以上 RAM。
- 为了更好地使用背景虚化及虚拟背景功能，推荐使用最新版桌面端 Google Chrome 浏览器。
- 背景虚化及虚拟背景功能付费功能，如需申请体验或咨询正式收费标准，请联系 ZEGO 商务人员。

## 实现流程

### 1 加载背景虚化及虚拟背景依赖的资源文件
将 npm 包中 /assets 目录下的所有资源文件放在您的项目根目录。

### 2 设置背景虚化及虚拟背景配置
在创建 ZegoUIKitPrebuilt 实例时，传入 `BackgroundProcessConfig` 参数，设置背景虚化及虚拟背景的配置。
```ts
/**
 * BackgroundProcessConfig 参数说明
 * BackgroundProcessConfig?: {
 *   blurDegree?: 1 | 2 | 3, // 虚化等级 1、2、3，等级越大，虚化程度越高
 *   source?: HTMLImageElement, // 虚拟背景图片的 HTMLImageElement
 *   objectFit?: 'fill' | 'contain' | 'cover', // 虚拟背景填充方式
 * }
*/
// 背景虚化
const zp = ZegoUIKitPrebuilt.create(kitToken, { BackgroundProcessConfig: { blurDegree: 1 } });

// 虚拟背景
const img = document.createElement("img");
img.src = require("./background.jpg"); // 您的背景图片路径
const zp = ZegoUIKitPrebuilt.create(kitToken, { BackgroundProcessConfig: { source: img, objectFit: "fill" } });
```

### 3 通过接口开启/关闭背景虚化及虚拟背景
在本地流创建成功后调用接口开启/关闭背景虚化及虚拟背景。
```ts
zp.joinRoom({
    // 本地流创建成功回调
    onLocalStreamCreated: (stream) => {
        // 开启
        await zp.openBackgroundProcess();
        // 关闭
        await zp.closeBackgroundProcess();
    }
})
```

### 4 显示开启/关闭背景虚化及虚拟背景按钮
若您想在房间内显示开启/关闭背景虚化及虚拟背景按钮，可通过 `showBackgroundProcessButton` 参数设置。
```ts
zp.joinRoom({
    showBackgroundProcessButton: true
})
```