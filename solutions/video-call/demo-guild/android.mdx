# 示例源码运行指引

本文介绍如何快速跑通示例源码，体验基础的音视频通话服务。

<Warning title="注意">

- 该源码仅供开发者接入时参考，ZEGO 不负责源码的后续维护。
- 若开发者计划将该源码用于生产环境，请确保发布前进行充分测试，避免发生潜在问题造成损失。
- 更多相关源码，请参考 [CodeStore](https://codestore.zego.im/)。
</Warning>

## 准备环境

在开始运行示例源码之前，请确保开发环境满足以下要求（以下说明皆以 macOS 开发电脑为例)：

* Android Studio 2020.3.1 或以上版本。
* Android SDK 31、Android SDK Platform-Tools 31.x.x 或以上版本。
* Android 8.0 或以上版本，且支持音视频的 Android 设备（仅支持真机），并开启“允许调试”选项。
* Android 设备、macOS 开发电脑已经连接到 Internet。
* Android Studio 的设置菜单，Gradle 配置 Gradle JDK 选择 Java 11。

<Note title="说明">
首次编译示例源码时，如果没有对应的依赖库或者构建工具，Android Studio 会自动下载示例源码，可能需要较长时间，请耐心等待。
</Note>


## 前提条件

- 已在 [ZEGO 控制台](https://console.zego.im) 创建项目，并申请有效的 AppID 和 AppSign，详情请参考 [控制台 - 项目管理 - 项目信息](/console/project-info)。
- 已开通即时通讯服务，详情请参考 [服务配置 - 即时通讯](https://doc-zh.zego.im/article/14994)。
- 已联系 ZEGO 商务人员，提供申请到的 AppID，以及自己项目的包名，开通 ZegoEffects SDK 相关权限。

## 获取示例源码

<Card title="示例源码" href="https://codestore.zego.im/project/14" >
CodeStore 下载
</Card>

## 运行示例源码

1. 在开发电脑中找到 Android Studio 软件图标。

   <Frame width="512" height="auto" caption=""><img src="https://storage.zego.im/sdk-doc/Pics/Android/ExpressSDK/SampleRunningGuide/open_as.png" /></Frame>

  <Accordion title="在开发电脑上安装 Android Studio 的方式" defaultOpen="false">
- 方式 1：登录 [Android Studio 官网](https://developer.android.com/studio) 下载并安装 Android Studio 及其相关的 SDK Tools。由于国内运营商网络限制等原因，开发者需要确保本机能连接该网站，若无法访问建议选择方式 2。
    - 方式 2：使用搜索引擎搜索 “Android Studio 下载”、“Android Studio 安装” 和 “Android Studio SDK Tools 安装”，查找可下载的源网站，并安装相关软件和工具。
</Accordion>


2. 打开 Android Studio，单击 “Open”。

   <Frame width="512" height="auto" caption="">
    <img src="https://storage.zego.im/sdk-doc/Pics/GoCall/call/gocall_android_open_project.png" />
    </Frame>

3. 在解压后的示例源码文件夹中，选择 GoCall_Android 文件夹，并单击 “Open” 打开。

    <Frame width="512" height="auto" caption="">
    <img src="https://storage.zego.im/sdk-doc/Pics/GoCall/call/demo_android_run_1.png" />
    </Frame>

4. 下载的示例源码中缺少 SDK 初始化所需的 appID 和 appSign，需要修改 “call/src/main/java/im/zego/call” 目录下的 “KeyCenter.java” 文件。请使用本文 [前提条件](#前提条件) 已获取的 AppID 和 AppSign 正确填写（**注意：需要在 AppID 后加 L**），否则示例源码无法正常运行。

    <Frame width="512" height="auto" caption="">
    <img src="https://storage.zego.im/sdk-doc/Pics/GoCall/call/demo_android_run_2.png" />
    </Frame>

5. 将 Android 设备链接到开发电脑，当该设备成功开启“开发者模式”和“USB 调试”功能后，可以看到 Android Studio 上方的 “Running Devices” 选项框由下图：  
    <Frame width="512" height="auto" caption="">
    <img src="https://storage.zego.im/sdk-doc/Pics/GoCall/call/demo_android_run_3.png" />
    </Frame>
   变为下图：  
    <Frame width="512" height="auto" caption="">
    <img src="https://storage.zego.im/sdk-doc/Pics/GoCall/call/demo_android_run_4.png" />
    </Frame>
   即 Android Studio 已成功连接到 Android 设备，可以将示例源码运行到该设备上了。
    
    <Note title="说明">
    - 当开发电脑连接 Android 设备后，大部分设备会弹出提示，不同 Android 厂商的提示信息有所不同，可根据情况选择 USB 模式。
    - 当 Android 设备连接开发电脑后，需要根据情况在该设备上开启开发者模式和 USB 调试功能（不同厂商的 Android 设备开启方式不同）。具体开启方式开发者可以需要自行搜索引擎搜索，例如：目前存在一台未开启过开发者模式与 USB 调试功能的某设备，可以在搜索引擎搜索“某设备开启开发者模式”，查看具体的开启教程。
    </Note>

6. 单击 “Run” 按钮，编译并运行示例源码。  
    <Frame width="512" height="auto" caption="">
    <img src="https://storage.zego.im/sdk-doc/Pics/GoCall/call/demo_android_run_5.png" />
    </Frame>

## 常见问题

1. **如果出现类似 "Android Gradle plugin requires Java 11 to run. You are currently using Java 1.8" 的错误信息，应该如何处理？**  
    请前往 “File > Project Structure > SDK Location > Gradle Settings” 升级 Gradle 版本，重新运行源码即可。   
    <Frame width="512" height="auto" caption=""><img src="https://storage.zego.im/sdk-doc/Pics/GoCall/call/project_structure.png" /></Frame>  
    <Frame width="512" height="auto" caption=""><img src="https://storage.zego.im/sdk-doc/Pics/GoCall/call/SDK_Location.png" /></Frame>  
    <Frame width="512" height="auto" caption=""><img src="https://storage.zego.im/sdk-doc/Pics/GoCall/call/FAQ1.png" /></Frame>

2. **如果出现错误信息 “Installation did not succeed. The application could not be installed: INSTALL_FAILED_CONFLICTING_PROVIDER”，应该如何处理？**  
    请卸载已经安装的 GoCall，然后重试。


3. **Android 示例源码运行时，如果报错 “Unrecognized option: --add-opens=java.base/java.io=ALL-UNNAMED”，该如何处理？**

<Frame width="512" height="auto" caption=""><img src="https://storage.zego.im/sdk-doc/Pics/GoEnjoy/AS_ALL_UNNAMED.png" /></Frame>

有两种解决方案：

- 升级 Android Studio 至最新版本，重新运行即可。

- 找到项目的 gradle.properties 文件，删除 `--add-opens=java.base/java.io=ALL-UNNAMED` 并保存，重新运行即可。

    <Frame width="512" height="auto" caption=""><img src="https://storage.zego.im/sdk-doc/Pics/GoEnjoy/AS_ALL_UNNAMED_delete.png" /></Frame>
