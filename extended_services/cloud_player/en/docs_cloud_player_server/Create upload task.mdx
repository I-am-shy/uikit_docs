# Create an upload task

- - -

<Note title="Note">

This feature is a value-added service. If you need to use it, please contact ZEGO sales team to activate it.
</Note>

## Overview

Call this interface to create an upload task to upload URL-based online resources to OSS. After the upload, the cloud player cluster in the same region can fetch the playback resources via the internal network stream address, ensuring the stability of the resource transfer proces.

## Request method and endpoint

- Request method: POST
- Request URL: `https://cloud-player-api.zego.im/?Action=CreateUploadTask`
- Protocol: HTTPS
- Rate limit: 20 times/second

    <Note title="Note">

    For a single AppID, ZEGOCLOUDâ€™s server can handle up to 10 upload tasks simultaneously (including tasks that are in progress or waiting). To increase this limit, please contact ZEGO technical support for modification.

    </Note>

## Request parameters

The following list only lists the interface request parameters. For common parameters, please refer to [Accessing server APIs - Common request parameters](./APIs%20method.mdx#2-common-parameters).

<table>
  
<tbody><tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
<tr>
<td>Title</td>
<td>String</td>
<td>Yes</td>
<td>File name, with a maximum length of 100B. File extensions (supporting <code>.mp3</code>, <code>.mp4</code>, <code>.flv</code>, <code>.wav</code>, <code>.aac</code>, and <code>.flac</code>) must be retained and correct; otherwise, it may lead to playback failure.<Warning title="Warning">Do not use the same file name. If multiple files have the same <code>Title</code>, they will overwrite each other, only keeping the last uploaded file. However, the new file might inherit the expiration time of the old file.</Warning></td>
</tr>
<tr>
<td>StreamUrl</td>
<td>String</td>
<td>Yes</td>
<td>The address of media resources must be a valid HTTP/HTTPS URL with a length within 1024 bytes, and the file size should not exceed 5GB.</td>
</tr>
<tr>
<td>RetentionDays</td>
<td>Number</td>
<td>No</td>
<td>The duration for which the resource is valid, measured in days. Valid values range from [1, 7] (default value: 3). If you need to increase this limit, please contact ZEGO technical support.</td>
</tr>
<tr>
<td>ContentMd5</td>
<td>String</td>
<td>No</td>
<td>ContentMd5 is the hash value generated by calculating the file using the MD5 algorithm and then encoding it with Base64, used to verify whether the file remains intact during upload.<br />If you provide the ContentMd5 parameter during upload, the ZEGOCLOUD server will calculate the ContentMd5 of the file via OSS and compare it with the value you provided. If they do not match, the upload will fail, indicating that the file may have been tampered with or corrupted.<br />To ensure the integrity and security of the file, it is strongly recommended to include the ContentMd5 parameter when uploading files.</td>
</tr>
</tbody></table>

The following codes demonstrates how to generate ContentMd5 using PHP:
```PHP
function calculateMD5($content) {
    return base64_encode(md5($content, true));
}
```

## Request example

#### Request URL

```bash
https://cloud-player-api.zego.im/?Action=CreateUploadTask
&AppId=1234567890
&SignatureNonce=15215528852396
&Timestamp=1234567890
&Signature=7a2c0f11145fb760d607a07b54825013
&SignatureVersion=2.0
&IsTest=false
```
#### Request body

```json
{
    "Title":"your-title.mp4",
    "StreamUrl": "https://xxx.com/video/test.mp4",
    "RetentionDays":3,
    "ContentMd5":"0uyh0doi++pDCwZkI0VEfA=="
}
```

## Response parameters

<table class="collapsible-table" >
  
<tbody><tr data-row-level="1">
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
<tr data-row-level="2">
<td>Code</td>
<td>Number</td>
<td>Error code.</td>
</tr>
<tr data-row-level="3">
<td>Message</td>
<td>String</td>
<td>Error description.</td>
</tr>
<tr data-row-level="4">
<td>RequestId</td>
<td>String</td>
<td>Request ID.</td>
</tr>
<tr data-row-level="5" data-row-child="true">
<td>Data</td>
<td>Object</td>
<td>Specific information returned.</td>
</tr>
<tr data-row-level="5-1">
<td>UploadTaskId</td>
<td>String</td>
<td>Unique identifier of the upload task.</td>
</tr>
<tr data-row-level="5-2">
<td>CreateTime</td>
<td>String</td>
<td>Task creation time, Unix timestamp in seconds.</td>
</tr>
</tbody></table>

## Response example

```json
{
    "Code": 0,
    "Message": "succeed",
    "RequestId": "955607951583870294",
    "Data": {
        "UploadTaskId": "upload_task_1",
        "CreateTime": 1681221508
    }
}
```

## Return codes

The following are only the return codes related to the interface business logic. For the complete list of return codes, please refer to [Return Codes](./return%20codes.mdx).

<table>
  
<tbody><tr>
<th>Return Code</th>
<th>Description</th>
<th>Suggested Action</th>
</tr>
<tr>
<td>0</td>
<td>Success.</td>
<td>-</td>
</tr>
<tr>
<td>100000004</td>
<td>Signature expired.</td>
<td>Please regenerate the signature.</td>
</tr>
<tr>
<td>100000005</td>
<td>Signature error.</td>
<td>Please confirm if the parameters used to generate the signature are correct.</td>
</tr>
<tr>
<td>350006001</td>
<td>Interface request frequency exceeds the limit.</td>
<td>Please confirm the QPS limit for the corresponding interface and reduce the request frequency.</td>
</tr>
<tr>
<td>350006002</td>
<td>Gateway verification failed.</td>
<td>Please contact ZEGOCLOUD technical support for assistance.</td>
</tr>
<tr>
<td>350006003</td>
<td>Invalid input parameters.</td>
<td>Please adjust the values of the corresponding parameters according to the Message prompt.</td>
</tr>
<tr>
<td>350006006</td>
<td>Service not activated.</td>
<td>Please contact ZEGOCLOUD technical support to activate the service.</td>
</tr>
<tr>
<td>350006010</td>
<td>The maximum concurrency for upload tasks has been reached.</td>
<td>Please check if the number of ongoing upload tasks exceeds the limit. The default limit is 10.</td>
</tr>
<tr>
<td>350010000</td>
<td>System error.</td>
<td>Please contact ZEGOCLOUD technical support for assistance.</td>
</tr>
</tbody></table>
