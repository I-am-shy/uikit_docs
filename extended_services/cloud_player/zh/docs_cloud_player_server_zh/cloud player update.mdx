@@@ServerAPIWarning@@@

# 更新云端播放器

- - -

## 描述

调用本接口更新指定云端播放器的播放进度、音频转码参数、视频转码参数等信息。

## 接口原型

- 请求方法：POST
- 请求地址：https://cloud-player-api.zego.im/?Action=UpdatePlayer
- 传输协议：HTTPS
- 调用频率限制：20 次/秒

## 请求参数

以下请求参数列表仅列出了接口请求参数，公共参数列表请参考 [调用方式 - 公共请求参数\|_blank](17857#4_1)。

<table class="collapsible-table" >
  
<tbody><tr data-row-level="1">
<th>参数</th>
<th>类型</th>
<th>是否必选</th>
<th>描述</th>
</tr>
<tr data-row-level="2">
<td>PlayerId</td>
<td>String</td>
<td>是</td>
<td><p>云端播放器唯一标识 ID，通过 <a href="/article/17859" target="blank">CreatePlayer</a> 返回。</p><p><b>调用本接口时，请确保 PlayerId 是已存在的，否则可能会出错。</b></p></td>
</tr>
<tr data-row-level="3">
<td>Sequence</td>
<td>Number</td>
<td>是</td>
<td><p>请求的序列号，用于保证时序，同个播放器任务的参数修改需要保证序列号的递增。例如："Sequence"：1。</p><p>ZEGO 服务器将按照最新的配置来更新云端播放器。</p></td>
</tr>
<tr data-row-level="4">
<td>StreamUrl</td>
<td>String</td>
<td>否</td>
<td>媒体资源的地址，必须是有效的 HTTP/HTTPS 地址，且长度在 1024 字节以内。</td>
</tr>
<tr data-row-level="5">
<td>BackupStreamUrl</td>
<td>String</td>
<td>否</td>
<td><p>媒体资源的备用地址，必须是有效的 HTTP/HTTPS 地址，且长度在 1024 字节以内。</p><p>当 StreamUrl 参数中的地址访问失败时，云端播放器会尝试访问备用地址。</p></td>
</tr>
<tr data-row-level="6" data-row-child="true">
<td>VideoOptions</td>
<td>Object</td>
<td>否</td>
<td><p>视频转码参数配置。</p><p><b>请注意，该参数不填写时，默认使用上一次调用本接口、或创建云端播放器时的配置。</b>
</p></td>
</tr>
<tr data-row-level="6-1">
<td>Width</td>
<td>Number</td>
<td>否</td>
<td><p>视频宽度，取值范围为 [1, 3000]，且必须是 2 的整倍数，单位为 px。</p><p><b>请注意，Width 和 Height 任意参数设置为 1 时，都表示纯音频推流；该参数不填写时，默认使用上一次调用本接口、或创建云端播放器时的配置。</b></p></td>
</tr>
<tr data-row-level="6-2">
<td>Height</td>
<td>Number</td>
<td>否</td>
<td><p>视频高度，取值范围为 [1, 3000]，且必须是 2 的整倍数，单位为 px。</p><p><b>请注意，Width 和 Height 任意参数设置为 1 时，都表示纯音频推流；该参数不填写时，默认使用上一次调用本接口、或创建云端播放器时的配置。</b></p></td>
</tr>
<tr data-row-level="6-3">
<td>VideoBitrate</td>
<td>Number</td>
<td>否</td>
<td><p>视频码率，取值范围为 [1, 50000]，单位为 kbps。</p><p><b>请注意，该参数不填写时，默认使用上一次调用本接口、或创建云端播放器时的配置。</b></p></td>
</tr>
<tr data-row-level="7" data-row-child="true">
<td>AudioOptions</td>
<td>Object</td>
<td>否</td>
<td><p>音频转码参数配置。</p><p><b>请注意，该参数不填写时，默认使用上一次调用本接口、或创建云端播放器时的配置。</b></p></td>
</tr>
<tr data-row-level="7-1">
<td>AudioBitrate</td>
<td>Number</td>
<td>否</td>
<td><p>音频码率，范围为 [1, 192]，单位为 kbps。</p><p><b>请注意，该参数不填写时，默认使用上一次调用本接口、或创建云端播放器时的配置。</b></p></td>
</tr>
<tr data-row-level="7-2">
<td>Volume</td>
<td>Number</td>
<td>否</td>
<td><p>音量值，范围为 [0, 200]。</p><p><b>请注意，该参数不填写时，默认使用上一次调用本接口、或创建云端播放器时的配置。</b></p></td>
</tr>
<tr data-row-level="8">
<td>SeekTo</td>
<td>Number</td>
<td>否</td>
<td><p>指定播放进度（秒）。</p><p><b>请注意，该参数不填写时，默认使用上一次调用本接口、或创建云端播放器时的配置。</b></p></td>
</tr>
<tr data-row-level="9">
<td>IsPause</td>
<td>Number</td>
<td>否</td>
<td><p>是否暂停播放。</p><ul><li>0：正常播放源文件。</li><li>1：暂停播放源文件。</li></ul></td>
</tr>
<tr data-row-level="10">
<td>RepeatTimes</td>
<td>Number</td>
<td>否</td>
<td><p>播放次数。</p><ul><li>1：播放媒体流 1 次。</li><li>-1：自动循环播放。</li><li>n：自定义播放媒体流次数，必须大于 0。</li></ul><p><strong>请注意，该参数不填写或值为  0 时，默认使用上一次调用本接口、或创建云端播放器时的配置。</strong></p></td>
</tr>
</tbody></table>

## 请求示例

#### 请求 URL
  
```
https://cloud-player-api.zego.im/?Action=UpdatePlayer
&AppId=1234567890
&SignatureNonce=15215528852396
&Timestamp=1234567890
&Signature=7a2c0f11145fb760d607a07b54825013
&SignatureVersion=2.0
&IsTest=false
```

#### 请求消息体  

```json
{
    "PlayerId": "player_1",
    "Sequence": 100,
    "StreamUrl": "https://your-bucket.oss-cn-shanghai.aliyuncs.com/video/test111.mp4",
    "BackupStreamUrl": "",
    "VideoOptions": {
        "Width": 360,
        "Height": 640,
        "VideoBitrate": 1200
    },
    "AudioOptions": {
        "AudioBitrate": 48,
        "Volume": 150
    },
    "SeekTo": 10,
    "IsPause": 1,
    "RepeatTimes": 1
}
```

## 响应参数

<table class="collapsible-table" >
  
<tbody><tr data-row-level="1">
<th>参数</th>
<th>类型</th>
<th>描述</th>
</tr>
<tr data-row-level="2">
<td>Code</td>
<td>Number</td>
<td>错误码。</td>
</tr>
<tr data-row-level="3">
<td>Message</td>
<td>String</td>
<td>错误描述。</td>
</tr>
<tr data-row-level="4">
<td>RequestId</td>
<td>String</td>
<td>请求 ID。</td>
</tbody></table>

## 响应示例

```json
{
    "Code": 0,
    "Message": "succeed",
    "RequestId": "abcd123"
}
```

## 返回码

以下仅列出了接口业务逻辑相关的返回码，完整返回码请参考 [全局返回码\|_blank](#17869)。

<table>
  
<tbody><tr>
<th>返回码</th>
<th>说明</th>
<th>处理建议</th>
</tr>
<tr>
<td>0</td>
<td>成功。</td>
<td>-</td>
</tr>
<tr>
<td>100000004</td>
<td>签名过期。</td>
<td>请重新生成签名。</td>
</tr>
<tr>
<td>100000005</td>
<td>签名错误。</td>
<td>请确认生成签名的参数是否正确。</td>
</tr>
<tr>
<td>350006001</td>
<td>接口请求频率超过上限。</td>
<td>请确认对应接口的 QPS 限制，降低请求频率。</td>
</tr>
<tr>
<td>350006002</td>
<td>网关校验失败。</td>
<td>请联系 ZEGO 技术支持处理。</td>
</tr>
<tr>
<td>350006003</td>
<td>无效的输入参数。</td>
<td>请根据 Message 提示，调整对应参数的取值。</td>
</tr>
<tr>
<td>350006006</td>
<td>服务未开通。</td>
<td>请联系 ZEGO 技术支持，开通服务权限。</td>
</tr>
<tr>
<td>350010000</td>
<td>系统错误。</td>
<td>请联系 ZEGO 技术支持处理。</td>
</tr>
</tbody></table>
