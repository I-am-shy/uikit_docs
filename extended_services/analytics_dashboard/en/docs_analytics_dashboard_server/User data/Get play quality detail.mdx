# Query User Pull Stream Quality and Performance Details

- - -

## Description

This interface can be used to query the pull stream quality and device performance based on the user ID, time period, room ID, and stream ID.

## Request method and endpoint

- Request method: GET
- Request URL: `https://analytics-api.zego.im/?Action=GetPlayQualityDetail`
- Transfer protocol: HTTPS
- QPS limit (same AppID): 3 times/second, 10000 times/day

## Request parameters

The following request parameter list only lists the interface request parameters and some common parameters. Please refer to [Accessing Server APIs - Public Request Parameters](./../Access%20server%20APIs.mdx#public-request-parameters) for the complete common parameter list.

<table>
  <colgroup>
    <col width="20%" />
    <col width="15%" />
    <col width="15%" />
    <col width="50%" />
  </colgroup>
<tbody><tr>
<th>Parameter</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
<tr>
<td>RoomId</td>
<td>String</td>
<td>Yes</td>
<td>Room ID.</td>
</tr>
<tr>
<td>UserId</td>
<td>String</td>
<td>Yes</td>
<td>User ID.</td>
</tr>
<tr>
<td>StreamId</td>
<td>String</td>
<td>Yes</td>
<td>Stream ID.</td>
</tr>
<tr>
<td>Metrics[]</td>
<td>Array of String</td>
<td>Yes</td>
<td>The list of metrics to be queried, please refer to [Pull Stream Quality Indicator Description](#pull-stream-quality-indicator-description) for details.</td>
</tr>
<tr>
<td>StartTs</td>
<td>Number</td>
<td>Yes</td>
<td>Start time, UTC timestamp in milliseconds.</td>
</tr>
<tr>
<td>EndTs</td>
<td>Number</td>
<td>Yes</td>
<td>End time, UTC timestamp in milliseconds. If the push stream is not ended, it can be represented as 0 or the current timestamp to indicate in progress.</td>
</tr>
</tbody></table>

### Pull Stream Quality Indicator Description

<table>
<tbody><tr>
<th>Indicator Name</th>
<th>Field Name</th>
<th>Data Type</th>
<th>Remark</th>
</tr>
<tr>
<td>Audio Bitrate</td>
<td>audio_bitrate</td>
<td>Int</td>
<td>Unit: Kbps</td>
</tr>
<tr>
<td>Audio Network FPS</td>
<td>audio_network_fps</td>
<td>Float</td>
<td>Unit: fps</td>
</tr>
<tr>
<td>Audio Break Percentage</td>
<td>audio_break_percentage</td>
<td>Float</td>
<td>Range: 0-100</td>
</tr>
<tr>
<td>Video Bitrate</td>
<td>video_bitrate</td>
<td>Float</td>
<td>Unit: Kbps</td>
</tr>
<tr>
<td>Video Network FPS</td>
<td>video_network_fps</td>
<td>Float</td>
<td>Unit: fps</td>
</tr>
<tr>
<td>Video Break Percentage</td>
<td>video_break_percentage</td>
<td>Float</td>
<td>Range: 0-100</td>
</tr>
<tr>
<td>Decode Resolution</td>
<td>decode_resolution</td>
<td>String</td>
<td>Format: Width*Height</td>
</tr>
<tr>
<td>Peer to Peer Delay</td>
<td>peer_to_peer_delay</td>
<td>Float</td>
<td>Unit: ms</td>
</tr>
<tr>
<td>Peer to Peer PLR</td>
<td>peer_to_peer_plr</td>
<td>Int</td>
<td>Range: 0-100</td>
</tr>
<tr>
<td>Downlink Delay</td>
<td>downlink_delay</td>
<td>Int</td>
<td>单位: ms</td>
</tr>
<tr>
<td>Downlink Packet Loss Rate</td>
<td>downlink_packet_loss_rate</td>
<td>Int</td>
<td>Range: 0-100</td>
</tr>
<tr>
<td>Rendered Sound Level</td>
<td>rendered_sound_level</td>
<td>Int</td>
<td>Range: 0-100</td>
</tr>
<tr>
<td>Audio MOS Score</td>
<td>mos</td>
<td>Float</td>
<td>Range: 0-5<ul><li>Greater than 4.0: Excellent, high-quality audio, clear and流畅。</li><li>3.5-4.0: Good, good audio quality, occasional audio quality damage, but still clear.</li><li>3.0-3.5: Medium, average audio quality, occasional stuttering, not very流畅，需要一点注意力才能听。</li><li>2.5-3.0: Poor audio quality, frequent stuttering,需要集中精力才能听清。</li><li>2.0-2.5: Very poor audio quality, occasional noise,部分语义丢失，难以交流。</li><li>Less than 2.0: Very poor audio quality,杂音频现，大量语义丢失，完全无法交流。</li></ul></td>
</tr>
<tr>
<td>System CPU Usage</td>
<td>sys_cpu_used</td>
<td>Int</td>
<td>Range: 0-100</td>
</tr>
<tr>
<td>App CPU Usage</td>
<td>app_cpu_used</td>
<td>Int</td>
<td>Range: 0-100</td>
</tr>
<tr>
<td>System Memory Usage</td>
<td>sys_mem_used</td>
<td>Int</td>
<td>Unit: MB</td>
</tr>
<tr>
<td>App Memory Usage</td>
<td>app_mem_used</td>
<td>Int</td>
<td>Unit: MB</td>
</tr>
</tbody></table>

## Request Example

```txt
https://analytics-api.zego.im/?Action=GetPlayQualityDetail
&RoomId=room
&UserId=userA
&StreamId=streamA
&Metrics[]=audio_bitrate
&Metrics[]=downlink_delay
&StartTs=1672565276000
&EndTs=1672565456000
&<Public Request Parameters>
```

## Response Parameters

<table class="collapsible-table">
  <colgroup>
    <col width="20%" />
    <col width="25%" />
    <col width="55%" />
  </colgroup>
<tbody><tr data-row-level="1">
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
<tr data-row-level="2">
<td>Code</td>
<td>Number</td>
<td>Return code.</td>
</tr>
<tr data-row-level="3">
<td>Message</td>
<td>String</td>
<td>Operation result description.</td>
</tr>
<tr data-row-level="4">
<td>RequestId</td>
<td>String</td>
<td>Request ID.</td>
</tr>
<tr data-row-level="5" data-row-child="true">
<td>Data</td>
<td>Object</td>
<td>Response data.</td>
</tr>
<tr data-row-level="5-1" data-row-child="true">
<td>└Metrics</td>
<td>Array of Object</td>
<td>Metric list.</td>
</tr>
<tr data-row-level="5-1-1">
<td>&nbsp;&nbsp;└Metric</td>
<td>String</td>
<td>Metric name.</td>
</tr>
<tr data-row-level="5-1-2" data-row-child="true">
<td>&nbsp;&nbsp;└Values</td>
<td>Array of Object</td>
<td>Metric value list.</td>
</tr>
<tr data-row-level="5-1-2-1">
<td>&nbsp;&nbsp;&nbsp;&nbsp;└Value</td><td>See [Pull Stream Quality Indicator Description](#pull-stream-quality-indicator-description)</td>
<td>Metric value.</td>
</tr>
<tr data-row-level="5-1-2-2">
<td>&nbsp;&nbsp;&nbsp;&nbsp;└Timestamp</td>
<td>Number</td>
<td>UTC timestamp, unit: milliseconds.</td>
</tr>
</tbody></table>

## Response Example

```json
{
    "Code": 0,
    "Data": {
        "Metrics": [
            {
                "Metric": "audio_bitrate",
                "Values": [
                    {
                        "Timestamp": 1659411660000,
                        "Value": 0
                    },
                    {
                        "Timestamp": 1659411720000,
                        "Value": 0
                    },
                    {
                        "Timestamp": 1659411780000,
                        "Value": 0
                    },
                    {
                        "Timestamp": 1659411840000,
                        "Value": 0
                    },
                    {
                        "Timestamp": 1659411900000,
                        "Value": 0
                    }
                ]
            }
        ]
    },
    "Message": "success",
    "RequestId": 1659512998878671000
}
```

## Return Code

| Return Code | Description | Action |
|--------|------|----------|
| 0      | Success. | -        |
| 500    | Interface error. | Contact ZEGOCLOUD Technical Support. |
| 10001  | Parameter format error. | Check parameters. |
| 10002  | Parameter error or parameter invalid. | Check parameters. |
| 30002  | Interface request frequency exceeds the limit. | Please confirm the QPS limit of the corresponding interface and reduce the request frequency. |
