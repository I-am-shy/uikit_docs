# 共享文件管理

- - -

@@@FileManagementOverview@@@

## 上传文件

@@@uploadFileClientDesc@@@

### 客户端 API
	 
@@@FileClassification@@@
@@@FileSpecifications@@@

<div class="multipletabs-content">
    <!--tabs列表-->
    <div class="item-tabs">
        <div class="scroll-box">
          <span class="tab-item">
             上传普通文件
          </span>
          <span class="tab-item">
             上传 H5 文件
          </span>
        </div>
    </div>
<div class="multipletabs-content-item ">
  <md-content>
调用 [uploadFile\|_blank](/article/api?doc=superboard_API~javascript_react-native~class~ZegoSuperBoardManager#upload-file) 方法上传普通文件。
```javascript
var file; // 待上传文件
if (!file) return alert('请先选择文件');
var zegoSuperBoard = ZegoSuperBoardManager.getInstance();

// 注册回调
zegoSuperBoard.on(
      "uploadFile",
      (
        state,
        errorCode,
        seq,
        upload_percent,
        fileID
      ) => {
        console.log(
          "superboard uploadFile callback",
          "state:",
          state,
          "errorCode:",
          errorCode,
          "seq:",
          seq,
          "upload_percent:",
          upload_percent,
          "fileID:",
          fileID
        );
      }
    );

// 上传文件后转码后渲染模式类型，如果用户涉及到 iOS、Web、Windows、Mac、小程序各端的业务，推荐使用 VectorAndIMG 模式。
zegoSuperBoard.uploadFile(file, renderType)
```
  </md-content>
</div>
<div class="multipletabs-content-item ">
  <md-content>
通过 [ZegoSuperboardCustomH5Config\|_blank](@-ZegoSuperboardCustomH5Config) 设置上传 H5 文件的配置参数，并调用 [uploadH5File\|_blank](/article/api?doc=superboard_API~javascript_react-native~class~ZegoSuperBoardManager#upload-h5-file-5) 方法上传 H5 文件。

``` javascript

var selectedH5File = null; // 当前选择的 H5 压缩包文件

var config = {
    width: 1600, // 自定义文件的宽
    height: 900, // 自定义文件的高
    pageCount: 7, // 自定义文件的页数
    // 自定义文件缩略图相对路径数组
    thumbnailList: ['thumbnail/1.png','thumbnail/2.png','thumbnail/3.png','thumbnail/4.png','thumbnail/5.png','thumbnail/6.png','thumbnail/7.png']
};

// 注册回调
zegoSuperBoard.on(
      "uploadH5File",
      (
        state,
        errorCode,
        seq,
        upload_percent,
        fileID
      ) => {
        console.log(
          "superboard uploadH5File callback",
          "state:",
          state,
          "errorCode:",
          errorCode,
          "seq:",
          seq,
          "upload_percent:",
          upload_percent,
          "fileID:",
          fileID
        );
      }
    );

zegoSuperBoard.uploadH5File(selectedH5File, config)
```
  </md-content>
</div>
</div>

调用客户端 API 接口上文件的过程包含：上传中、排队中、转换中、和转换成功等多个阶段。具体上传状态请查看 [ZegoSuperBoardUploadFileState\|_blank](@-ZegoSuperBoardUploadFileState)

- 上传阶段：如果正常上传，会产生多次回调，每次都包含文件上传进度。例如当前上传 50%，则 "upload_percent" 显示为 0.50 ；当前上传 100%，则 "upload_percent" 显示为 1。
- 格式转换阶段：如果转换成功，只产生一次回调，包含转换后的文件 ID。例如当前转换完成，则回调返回的内容为 `{"fileID":"ekxxxxxxxxv"}`。

### 服务端 API

@@@TrsancodeServerAPI@@@

## 缓存文件

当用户上传文件并获取文件的 fileID 之后，如需提高文件加载速度，可以在调用 [ZegoSuperBoardManager\|_blank](@-ZegoSuperBoardManager) 的 [createFileView\|_blank](@createFileView) 接口创建文件白板之前，提前缓存该文件。

调用 [cacheFile\|_blank](/article/api?doc=superboard_API~javascript_react-native~class~ZegoSuperBoardManager#cache-file) 方法提前请求该文件中的资源。

``` javascript
var zegoSuperBoard = ZegoSuperBoardManager.getInstance();

// 注册回调
 zegoSuperBoard.on(
      "cacheFile",
      (
        state,
        errorCode,
        seq,
        percent,
        fileID
      ) => {
        console.log(
          "superboard cacheFile callback",
          "state:",
          state,
          "errorCode:",
          errorCode,
          "seq:",
          seq,
          "percent:",
          percent,
          "fileID:",
          fileID
        );
      }
    );

zegoSuperBoard.cacheFile(fileID)

```
